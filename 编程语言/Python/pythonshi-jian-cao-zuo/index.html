<!doctype html><html lang=zh-Hans-CN><head><title>modao's blog</title><meta content="text/html; charset=utf-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1.0,maximum-scale=1" name=viewport><meta content=noodp name=robots><link href=https://modao.site/style.css rel=stylesheet><link href=https://modao.site/color/green.css rel=stylesheet><link href=https://modao.site/color/background_dark.css rel=stylesheet><link href=https://modao.site/font-hack.css rel=stylesheet><script src="https://www.googletagmanager.com/gtag/js?id=G-N2WTGJE0M5" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-N2WTGJE0M5');</script><body><div class=container><header class=header><div class=header__inner><div class=header__logo><a style="text-decoration: none;" href=https://modao.site> <div class=logo>MODAO</div> </a></div></div><nav class=menu><ul class=menu__inner><li class=active><a href=https://modao.site>Home</a><li><a href=https://modao.site/tags>Tags</a><li><a href=https://modao.site/language>Programming-Language</a><li><a href=https://modao.site/books>Books</a><li><a href=https://modao.site/links>Links</a><li><a href=https://modao.site/friend>Friend</a></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=https://modao.site/编程语言/Python/pythonshi-jian-cao-zuo/>(转载)Python 时间操作</a></h1><div class=post-meta-inline><span class=post-date> 2021-03-01 </span></div><div class=post-content><p>原文：<a href=https://www.cnblogs.com/CharmCode/p/14142843.html>Python 时间操作</a><h2 id=strptime-de-shi-yong>strptime 的使用</h2><p><code>strptime</code>是python <code>datetime</code>库中的函数，用于将一个日期字符串转成datetime日期格式便于后期处理<p><strong>使用格式</strong>为<code>datetime.strptime(date_string, format)</code><ul><li><code>date_string</code>：要转成日期的字符串<li><code>format</code>：匹配格式，根据<code>date_string</code>的不同而不同</ul><p><code>format</code> 有以下格式：<p><img alt=img src=Python%E6%97%B6%E9%97%B4%E6%93%8D%E4%BD%9C/20160627170308271><h2 id=huo-qu-ling-chen-shi-jian>获取凌晨时间</h2><p>网上查的大部分都是用时间戳相减，或者用时区的方式，总感觉不是很好<pre class=language-python data-lang=python style=background-color:#2b303b;color:#c0c5ce;><code class=language-python data-lang=python><span style=color:#65737e;># 方法一 获取凌晨时间戳</span><span style=color:#65737e;>
</span><span style=color:#b48ead;>import </span><span>time</span><span>
</span><span style=color:#b48ead;>import </span><span>datetime</span><span>
</span><span>
</span><span style=color:#65737e;># 思路特别简单 </span><span style=color:#65737e;>
</span><span>dt = time.</span><span style=color:#bf616a;>strftime</span><span>("</span><span style=color:#d08770;>%Y</span><span style=color:#a3be8c;>-</span><span style=color:#d08770;>%m</span><span style=color:#a3be8c;>-</span><span style=color:#d08770;>%d</span><span>")</span><span>
</span><span style=color:#96b5b4;>print</span><span>(dt)  </span><span style=color:#65737e;># 先得到前缀 2019-12-13</span><span style=color:#65737e;>
</span><span> 这种，然后在拼接成2019-</span><span style=color:#d08770;>12</span><span>-</span><span style=color:#d08770;>13</span><span>
</span><span> </span><span style=color:#d08770;>00</span><span>:</span><span style=color:#d08770;>00</span><span>:</span><span style=color:#d08770;>00</span><span>
</span><span>time_array = time.</span><span style=color:#bf616a;>strptime</span><span>(</span><span style=color:#b48ead;>f</span><span>"{dt}</span><span style=color:#a3be8c;> 00:00:00</span><span>", "</span><span style=color:#d08770;>%Y</span><span style=color:#a3be8c;>-</span><span style=color:#d08770;>%m</span><span style=color:#a3be8c;>-</span><span style=color:#d08770;>%d %H</span><span style=color:#a3be8c;>:</span><span style=color:#d08770;>%M</span><span style=color:#a3be8c;>:</span><span style=color:#d08770;>%S</span><span>")</span><span>
</span><span style=color:#65737e;># 然后转化为时间戳，思路特别简单</span><span style=color:#65737e;>
</span><span>timestamp = time.</span><span style=color:#bf616a;>mktime</span><span>(time_array)</span><span>
</span><span style=color:#96b5b4;>print</span><span>(</span><span style=color:#bf616a;>int</span><span>(timestamp) * </span><span style=color:#d08770;>1000</span><span>)</span><span>
</span><span>
</span><span>
</span><span style=color:#65737e;># 方法二 刚搜出来的，感觉不错</span><span style=color:#65737e;>
</span><span>day_time = time.</span><span style=color:#bf616a;>mktime</span><span>(datetime.date.</span><span style=color:#bf616a;>today</span><span>().</span><span style=color:#bf616a;>timetuple</span><span>())</span><span>
</span><span style=color:#96b5b4;>print</span><span>(</span><span style=color:#bf616a;>int</span><span>(day_time) * </span><span style=color:#d08770;>1000</span><span>)</span><span>
</span></code></pre><h2 id=ge-shi-hua-shi-jian-bi-da-xiao>格式化时间比大小</h2><pre class=language-python data-lang=python style=background-color:#2b303b;color:#c0c5ce;><code class=language-python data-lang=python><span style=color:#b48ead;>import </span><span>datetime</span><span>
</span><span>
</span><span>d1 = datetime.datetime.</span><span style=color:#bf616a;>strptime</span><span>('</span><span style=color:#a3be8c;>2020-01-05</span><span style=background-color:#bf616a;color:#2b303b;>
</span><span> </span><span style=color:#d08770;>18</span><span>:</span><span style=color:#d08770;>22</span><span>:</span><span style=color:#d08770;>22</span><span>'</span><span style=color:#a3be8c;>, </span><span>'%Y-%m-%d %H:%M:%S'</span><span style=color:#a3be8c;>)</span><span style=background-color:#bf616a;color:#2b303b;>
</span><span style=color:#bf616a;>d2 </span><span>= datetime.datetime.</span><span style=color:#bf616a;>strptime</span><span>('</span><span style=color:#a3be8c;>2020-01-01</span><span style=background-color:#bf616a;color:#2b303b;>
</span><span> </span><span style=color:#d08770;>12</span><span>:</span><span style=color:#d08770;>24</span><span>:</span><span style=color:#d08770;>15</span><span>'</span><span style=color:#a3be8c;>, </span><span>'%Y-%m-%d %H:%M:%S'</span><span style=color:#a3be8c;>)</span><span style=background-color:#bf616a;color:#2b303b;>
</span><span style=color:#65737e;># 判断大小</span><span style=color:#65737e;>
</span><span style=color:#96b5b4;>print</span><span>(d2 > d1)  </span><span style=color:#65737e;># False</span><span style=color:#65737e;>
</span><span style=color:#96b5b4;>print</span><span>(d2 < d1)  </span><span style=color:#65737e;># True</span><span style=color:#65737e;>
</span><span style=color:#65737e;># 计算间隔天数</span><span style=color:#65737e;>
</span><span style=color:#bf616a;>delta </span><span>= d1 - d2</span><span>
</span><span style=color:#96b5b4;>print</span><span>(delta.days)  </span><span style=color:#65737e;># 输出 4 </span><span style=color:#65737e;>
</span></code></pre><h2 id=yue-ri-zhi-qu-zheng-shu>月,日只取整数</h2><pre class=language-python data-lang=python style=background-color:#2b303b;color:#c0c5ce;><code class=language-python data-lang=python><span style=color:#b48ead;>import </span><span>time</span><span>
</span><span>
</span><span>dt = time.</span><span style=color:#bf616a;>strftime</span><span>("</span><span style=color:#d08770;>%Y</span><span style=color:#a3be8c;>-</span><span style=color:#d08770;>%m</span><span style=color:#a3be8c;>-</span><span style=color:#d08770;>%d</span><span>")</span><span>
</span><span style=color:#96b5b4;>print</span><span>(dt) </span><span style=color:#65737e;># 输出 2020-05-05</span><span style=color:#65737e;>
</span><span>
</span><span>
</span><span style=color:#65737e;># 但是我只想要 2020-05-5这样的格式， %后母加- 如 %-m  %-d</span><span style=color:#65737e;>
</span><span>dt = time.</span><span style=color:#bf616a;>strftime</span><span>("</span><span style=color:#d08770;>%Y</span><span style=color:#a3be8c;>-</span><span style=color:#d08770;>%-m</span><span style=color:#a3be8c;>-</span><span style=color:#d08770;>%-d</span><span>")</span><span>
</span><span style=color:#96b5b4;>print</span><span>(dt) </span><span style=color:#65737e;># 输出 2020-05-5</span><span style=color:#65737e;>
</span></code></pre><h2 id=huo-qu-zuo-tian-ming-tian-deng-shi-jian>获取昨天，明天等时间</h2><pre class=language-python data-lang=python style=background-color:#2b303b;color:#c0c5ce;><code class=language-python data-lang=python><span style=color:#65737e;># 当前参考时间为 2020-04-27</span><span style=color:#65737e;>
</span><span style=color:#b48ead;>from </span><span>datetime </span><span style=color:#b48ead;>import </span><span>timedelta, date</span><span>
</span><span style=color:#65737e;># 获取昨日时间对象</span><span style=color:#65737e;>
</span><span>yesterday_obj = date.</span><span style=color:#bf616a;>today</span><span>() + </span><span style=color:#bf616a;>timedelta</span><span>(</span><span style=color:#bf616a;>days</span><span>=-</span><span style=color:#d08770;>1</span><span>)</span><span>
</span><span style=color:#96b5b4;>print</span><span>(yesterday_obj)  </span><span style=color:#65737e;># 输出昨日凌晨对象 class: datetime.date(2020, 4, 26)</span><span style=color:#65737e;>
</span><span>
</span><span style=color:#65737e;># 获取昨天时间格式</span><span style=color:#65737e;>
</span><span>yesterday_str = (date.</span><span style=color:#bf616a;>today</span><span>() + </span><span style=color:#bf616a;>timedelta</span><span>(</span><span style=color:#bf616a;>days</span><span>=-</span><span style=color:#d08770;>1</span><span>)).</span><span style=color:#bf616a;>strftime</span><span>("</span><span style=color:#d08770;>%Y</span><span style=color:#a3be8c;>-</span><span style=color:#d08770;>%m</span><span style=color:#a3be8c;>-</span><span style=color:#d08770;>%d %H</span><span style=color:#a3be8c;>:</span><span style=color:#d08770;>%M</span><span style=color:#a3be8c;>:</span><span style=color:#d08770;>%S</span><span>")</span><span>
</span><span style=color:#96b5b4;>print</span><span>(yesterday_str)  </span><span style=color:#65737e;># 输出昨日凌晨时间 str:'2020-04-26</span><span style=color:#65737e;>
</span><span> </span><span style=color:#d08770;>00</span><span>:</span><span style=color:#d08770;>00</span><span>:</span><span style=color:#d08770;>00</span><span>'</span><span style=background-color:#bf616a;color:#2b303b;>
</span><span>
</span><span style=color:#65737e;># 获取前天 直接days=-2</span><span style=color:#65737e;>
</span><span>
</span><span>
</span><span style=color:#65737e;># 获取明日时间对象</span><span style=color:#65737e;>
</span><span>tomorrow_obj = date.</span><span style=color:#bf616a;>today</span><span>() + </span><span style=color:#bf616a;>timedelta</span><span>(</span><span style=color:#bf616a;>days</span><span>=+</span><span style=color:#d08770;>1</span><span>)</span><span>
</span><span style=color:#96b5b4;>print</span><span>(tomorrow_obj)   </span><span style=color:#65737e;># 输出明日时间对象 class: datetime.date(2020, 4, 28)</span><span style=color:#65737e;>
</span><span>
</span><span style=color:#65737e;># 获取民日时间格式化字符串</span><span style=color:#65737e;>
</span><span>tomorrow_str = (date.</span><span style=color:#bf616a;>today</span><span>() + </span><span style=color:#bf616a;>timedelta</span><span>(</span><span style=color:#bf616a;>days</span><span>=+</span><span style=color:#d08770;>1</span><span>)).</span><span style=color:#bf616a;>strftime</span><span>("</span><span style=color:#d08770;>%Y</span><span style=color:#a3be8c;>-</span><span style=color:#d08770;>%m</span><span style=color:#a3be8c;>-</span><span style=color:#d08770;>%d %H</span><span style=color:#a3be8c;>:</span><span style=color:#d08770;>%M</span><span style=color:#a3be8c;>:</span><span style=color:#d08770;>%S</span><span>")</span><span>
</span><span style=color:#96b5b4;>print</span><span>(tomorrow_str)   </span><span style=color:#65737e;># 输出明日凌晨时间 str:'2020-04-28</span><span style=color:#65737e;>
</span><span> </span><span style=color:#d08770;>00</span><span>:</span><span style=color:#d08770;>00</span><span>:</span><span style=color:#d08770;>00</span><span>'</span><span style=background-color:#bf616a;color:#2b303b;>
</span></code></pre><h2 id=shi-jian-chuo-ge-shi-hua-shi-jian>时间戳格式化时间</h2><pre class=language-python data-lang=python style=background-color:#2b303b;color:#c0c5ce;><code class=language-python data-lang=python><span style=color:#b48ead;>import </span><span>time</span><span>
</span><span>
</span><span>time.</span><span style=color:#bf616a;>strftime</span><span>("</span><span style=color:#d08770;>%Y</span><span style=color:#a3be8c;>-</span><span style=color:#d08770;>%m</span><span style=color:#a3be8c;>-</span><span style=color:#d08770;>%d %H</span><span style=color:#a3be8c;>:</span><span style=color:#d08770;>%M</span><span style=color:#a3be8c;>:</span><span style=color:#d08770;>%S</span><span>", time.</span><span style=color:#bf616a;>localtime</span><span>(</span><span style=color:#d08770;>1605781931</span><span>))</span><span>
</span><span style=color:#65737e;># 输出 '2020-11-19</span><span style=color:#65737e;>
</span><span> </span><span style=color:#d08770;>18</span><span>:</span><span style=color:#d08770;>32</span><span>:</span><span style=color:#d08770;>11</span><span>'</span><span style=background-color:#bf616a;color:#2b303b;>
</span></code></pre><h2 id=ge-shi-hua-te-shu-shi-jian-zi-fu-chuan-2020-10-16>格式化特殊时间字符串 "2020-10-16</h2><p>T17:36:00+08:00"<pre class=language-python data-lang=python style=background-color:#2b303b;color:#c0c5ce;><code class=language-python data-lang=python><span style=color:#b48ead;>import </span><span>datetime</span><span>
</span><span>t = "</span><span style=color:#a3be8c;>2020-10-16</span><span style=background-color:#bf616a;color:#2b303b;>
</span><span>T17:</span><span style=color:#d08770;>36</span><span>:</span><span style=color:#d08770;>00</span><span>+08:</span><span style=color:#d08770;>00</span><span>"</span><span style=background-color:#bf616a;color:#2b303b;>
</span><span>
</span><span>new_t = datetime.datetime.</span><span style=color:#bf616a;>strptime</span><span>(t,"</span><span style=color:#d08770;>%Y</span><span style=color:#a3be8c;>-</span><span style=color:#d08770;>%m</span><span style=color:#a3be8c;>-</span><span style=color:#d08770;>%d</span><span style=color:#a3be8c;>T</span><span style=color:#d08770;>%H</span><span style=color:#a3be8c;>:</span><span style=color:#d08770;>%M</span><span style=color:#a3be8c;>:</span><span style=color:#d08770;>%S</span><span style=color:#a3be8c;>+08:00</span><span>").</span><span style=color:#bf616a;>strftime</span><span>("</span><span style=color:#d08770;>%Y</span><span style=color:#a3be8c;>-</span><span style=color:#d08770;>%m</span><span style=color:#a3be8c;>-</span><span style=color:#d08770;>%d %H</span><span style=color:#a3be8c;>:</span><span style=color:#d08770;>%M</span><span style=color:#a3be8c;>:</span><span style=color:#d08770;>%S</span><span>")</span><span>
</span><span style=color:#65737e;># '2020-10-16</span><span style=color:#65737e;>
</span><span> </span><span style=color:#d08770;>17</span><span>:</span><span style=color:#d08770;>36</span><span>:</span><span style=color:#d08770;>00</span><span>'</span><span style=background-color:#bf616a;color:#2b303b;>
</span><span>
</span><span>
</span><span>t2 = "</span><span style=color:#a3be8c;>2020-10-16</span><span style=background-color:#bf616a;color:#2b303b;>
</span><span>T17:</span><span style=color:#d08770;>36</span><span>:</span><span style=color:#d08770;>00</span><span>Z"</span><span style=background-color:#bf616a;color:#2b303b;>
</span><span>new_t2 = datetime.datetime.</span><span style=color:#bf616a;>strptime</span><span>(t2,"</span><span style=color:#d08770;>%Y</span><span style=color:#a3be8c;>-</span><span style=color:#d08770;>%m</span><span style=color:#a3be8c;>-</span><span style=color:#d08770;>%d</span><span style=color:#a3be8c;>T</span><span style=color:#d08770;>%H</span><span style=color:#a3be8c;>:</span><span style=color:#d08770;>%M</span><span style=color:#a3be8c;>:</span><span style=color:#d08770;>%S</span><span style=color:#a3be8c;>Z</span><span>").</span><span style=color:#bf616a;>strftime</span><span>("</span><span style=color:#d08770;>%Y</span><span style=color:#a3be8c;>-</span><span style=color:#d08770;>%m</span><span style=color:#a3be8c;>-</span><span style=color:#d08770;>%d %H</span><span style=color:#a3be8c;>:</span><span style=color:#d08770;>%M</span><span style=color:#a3be8c;>:</span><span style=color:#d08770;>%S</span><span>")</span><span>
</span><span style=color:#65737e;># '2020-10-16</span><span style=color:#65737e;>
</span><span> </span><span style=color:#d08770;>17</span><span>:</span><span style=color:#d08770;>36</span><span>:</span><span style=color:#d08770;>00</span><span>'</span><span style=background-color:#bf616a;color:#2b303b;>
</span></code></pre><h2 id=shi-jian-chuo-huan-yuan-cheng-datetimedui-xiang>时间戳还原成<code>datetime</code>对象</h2><pre class=language-python data-lang=python style=background-color:#2b303b;color:#c0c5ce;><code class=language-python data-lang=python><span style=color:#b48ead;>from </span><span>datetime </span><span style=color:#b48ead;>import </span><span>datetime</span><span>
</span><span>
</span><span>ts = </span><span style=color:#d08770;>1608902287.504388</span><span>
</span><span>
</span><span>d = datetime.</span><span style=color:#bf616a;>fromtimestamp</span><span>(t)</span><span>
</span><span style=color:#65737e;># datetime.datetime(2020, 12, 25, 21, 18, 7, 504388)</span><span style=color:#65737e;>
</span></code></pre><blockquote><p>发现其他博客也介绍的很详细,留下链接以便日后查看</blockquote><ul><li><a href=https://stackoverflow.com/questions/17594298/date-time-formats-in-python>StackOverflow 格式化时间</a><li><a href=https://blog.csdn.net/wto882dim/article/details/102898632>CSDN Python时间戳</a> https://blog.csdn.net/wto882dim/article/details/102898632</ul></div></div></div><footer class=footer__poweredby><p class=caption>© 2022 All Rights Reserved modao::rustacean@aliyun.com<p class=caption>© Powered by <a href=https://www.getzola.org/>Zola</a><p class=caption>© Theme: <a href=https://github.com/pawroman/zola-theme-terminimal/>Terminimal</a> by pawroman<p class=caption><a href=https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh rel=license>自由转载-非商用-非衍生-保持署名</a></footer></div>