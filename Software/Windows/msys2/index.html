<!doctype html><html lang=zh-Hans-CN><head><title>modao's blog</title><meta content="text/html; charset=utf-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1.0,maximum-scale=1" name=viewport><meta content=noodp name=robots><link href=https://modao.site/style.css rel=stylesheet><link href=https://modao.site/color/green.css rel=stylesheet><link href=https://modao.site/color/background_dark.css rel=stylesheet><link href=https://modao.site/font-hack.css rel=stylesheet><body><div class=container><header class=header><div class=header__inner><div class=header__logo><a style="text-decoration: none;" href=https://modao.site> <div class=logo>MODAO</div> </a></div></div><nav class=menu><ul class=menu__inner><li class=active><a href=https://modao.site>Home</a><li><a href=https://modao.site/tags>Tags</a><li><a href=https://modao.site/language>Programming-Language</a><li><a href=https://modao.site/books>Books</a><li><a href=https://modao.site/links>Links</a><li><a href=https://modao.site/friend>Friend</a></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=https://modao.site/Software/Windows/msys2/>msys2配置</a></h1><div class=post-meta-inline><span class=post-date> 2020-08-08 </span></div><span class=post-tags-inline> :: tags:  <a class=post-tag href=https://modao.site/tags/software/>#Software</a>  <a class=post-tag href=https://modao.site/tags/windows/>#Windows</a></span><div class=post-content><p>msys2配置<h2 id=pei-zhi-guo-nei-jing-xiang>配置国内镜像</h2><p>国内镜像战有中科大的源和清华的源，中科大是http，清华是https，所以我选用了清华的。<p>我的配置原则是删除默认全部，只保留国内镜像一条。<p>编辑 <code>/etc/pacman.d/mirrorlist.mingw32</code> ，在文件开头添加：<pre style=background-color:#2b303b;color:#c0c5ce;><code><span>Server = https://mirrors.tuna.tsinghua.edu.cn/msys2/mingw/i686
</span></code></pre><p>编辑 <code>/etc/pacman.d/mirrorlist.mingw64</code> ，在文件开头添加：<pre style=background-color:#2b303b;color:#c0c5ce;><code><span>Server = https://mirrors.tuna.tsinghua.edu.cn/msys2/mingw/x86_64
</span></code></pre><p>编辑 <code>/etc/pacman.d/mirrorlist.msys</code> ，在文件开头添加：<pre style=background-color:#2b303b;color:#c0c5ce;><code><span>Server = https://mirrors.tuna.tsinghua.edu.cn/msys2/msys/$arch
</span></code></pre><p>然后执行 <code>pacman -Sy</code> 刷新软件包数据即可。<h2 id=msys2xi-tong-geng-xin>msys2系统更新</h2><pre style=background-color:#2b303b;color:#c0c5ce;><code><span>pacman -Syu
</span></code></pre><ul><li>更新时会遇到警告，根据警告信息提示，我们可以关闭窗口<li>点击关闭窗口按钮后会弹出一个警告框提示，提示信息是窗口会话有进程正在运行，这里不用管，点OK就行。</ul><p>到这里更新并没有结束，重复配置源部分，再打开msys2进行更新即可。<h2 id=mi-yao-shi-xiao-wen-ti>密钥失效问题</h2><p>使用<code>pacman -Syu</code>时显示无法远程查找到密钥。<h3 id=cuo-wu-yuan-yin>错误原因</h3><p>密钥无法信赖(rely on)msys2-keyring密钥服务器，如果不及时更新msys2-keyring，就会出现上面的错误提示。<h3 id=xiu-fu-ban-fa>修复办法：</h3><p>msys2官方提供了一个msys2-keyring-r21.b39fb11-1-any.pkg.tar.xz的软件包来修复。<p>修复前验证下（无法通过）：<pre style=background-color:#2b303b;color:#c0c5ce;><code><span># pacman-key --verify msys2-keyring-r21.b39fb11-1-any.pkg.tar.xz{.sig,}
</span></code></pre><p>开始修复：<ol><li><p><strong>下载 msys2-keyring-r21.b39fb11-1-any.pkg.tar.xz 软件包</strong></p> <pre style=background-color:#2b303b;color:#c0c5ce;><code><span># curl -O http://repo.msys2.org/msys/x86_64/msys2-keyring-r21.b39fb11-1-any.pkg.tar.xz
</span><span># curl -O http://repo.msys2.org/msys/x86_64/msys2-keyring-r21.b39fb11-1-any.pkg.tar.xz.sig
</span></code></pre><li><p><strong>验证签名是否建立完好</strong></p> <pre style=background-color:#2b303b;color:#c0c5ce;><code><span># pacman-key --verify msys2-keyring-r21.b39fb11-1-any.pkg.tar.xz{.sig,}
</span></code></pre><li><p><strong>安装 msys2-keyring-r21.b39fb11-1-any.pkg.tar.xz 包</strong></p> <pre style=background-color:#2b303b;color:#c0c5ce;><code><span># pacman -U --config <(echo) msys2-keyring-r21.b39fb11-1-any.pkg.tar.xz
</span></code></pre><li><p><strong>然后就可以使用<code>pacman -Syu</code>进行更新</strong></p></ol><blockquote><p>【注1】<p>如果还存在签名问题导致无法更新，可以尝试重置<code>pacman key</code>：<p><code># rm -r /etc/pacman.d/gnupg/</code><p><code># pacman-key --init</code><p><code># pacman-key --populate msys2</code><p>然后再<code>pacman -Syu</code>进行更新<p>【注2】<p>修复完毕后，可能需要重启计算机。</blockquote><h2 id=can-kao-wen-zhang>参考文章</h2><p><a href=https://blog.csdn.net/xfijun/article/details/107810097>解决msys2“无法升级 mingw64 (无效或已损坏的数据库 (PGP 签名))”密钥失效问题</a><p><a href=https://www.cnblogs.com/CodeWorkerLiMing/p/12274583.html>MSYS2使用教程（整理）——win10系统64位安装msys2最新版（msys2-x86_64-20190524.exe）</a></div></div></div><footer class=footer__poweredby><p class=caption>© 2022 All Rights Reserved modao::rustacean@aliyun.com<p class=caption>© Powered by <a href=https://www.getzola.org/>Zola</a><p class=caption>© Theme: <a href=https://github.com/pawroman/zola-theme-terminimal/>Terminimal</a> by pawroman<p class=caption><a href=https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh rel=license>自由转载-非商用-非衍生-保持署名</a></footer></div>