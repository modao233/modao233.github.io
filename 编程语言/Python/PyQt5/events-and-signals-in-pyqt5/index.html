<!doctype html><html lang=zh-Hans-CN><head><title>modao's blog</title><meta content="text/html; charset=utf-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1.0,maximum-scale=1" name=viewport><meta content=noodp name=robots><link href=https://modao.site/style.css rel=stylesheet><link href=https://modao.site/color/green.css rel=stylesheet><link href=https://modao.site/color/background_dark.css rel=stylesheet><link href=https://modao.site/font-hack.css rel=stylesheet><body><div class=container><header class=header><div class=header__inner><div class=header__logo><a style="text-decoration: none;" href=https://modao.site> <div class=logo>MODAO</div> </a></div></div><nav class=menu><ul class=menu__inner><li class=active><a href=https://modao.site>Home</a><li><a href=https://modao.site/tags>Tags</a><li><a href=https://modao.site/language>Programming-Language</a><li><a href=https://modao.site/books>Books</a><li><a href=https://modao.site/links>Links</a><li><a href=https://modao.site/friend>Friend</a></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=https://modao.site/编程语言/Python/PyQt5/events-and-signals-in-pyqt5/>PyQt5 中的事件和信号</a></h1><div class=post-meta-inline><span class=post-date> 2020-08-19 </span></div><div class=post-content><p><a href=http://zetcode.com/gui/pyqt5/eventssignals/>翻译自原文：Events and signals in PyQt5</a><p>翻译时间 2020 年 8 月 19 日<p>在 PyQt5 编程教程的这一部分中，我们将探讨应用程序中发生的事件和信号。<h2 id=pyqt5-zhong-de-shi-jian>PyQt5 中的事件</h2><p>GUI 应用程序是事件驱动的，事件主要由应用程序的用户生成。但是，它们也可以通过其他方式产生，例如，互联网连接、窗口管理器或计时器。当我们调用应用程序的<code>exec_()</code>方法时，应用程序进入主循环。主循环获取事件并将其发送到对象。<p>在活动模型中，有三个参与者：<ul><li>事件源<li>事件对象<li>事件目标</ul><p>事件源是状态更改的对象，它生成事件。<p>事件对象（事件）封装事件源中的状态更改。<p>事件目标是想要收到通知的对象。事件源对象将处理事件的任务委托给事件目标。<p>PyQt5 具有独特的信号和插槽机制来处理事件。信号和插槽用于对象之间的通信。发生特定事件时发出信号。插槽可以是任何可调用的 Python 程序。发出连接信号时调用插槽。<h2 id=pyqt5-xin-hao-he-cha-cao>PyQt5 信号和插槽</h2><p>这是一个简单的示例，演示 PyQt5 中的信号和插槽。<p>signals_slots.py<pre class=language-python data-lang=python style=background-color:#2b303b;color:#c0c5ce;><code class=language-python data-lang=python><span style=color:#b48ead;>import </span><span>sys</span><span>
</span><span style=color:#b48ead;>from </span><span>PyQt5.QtCore </span><span style=color:#b48ead;>import </span><span>Qt</span><span>
</span><span style=color:#b48ead;>from </span><span>PyQt5.QtWidgets </span><span style=color:#b48ead;>import </span><span>(QWidget, QLCDNumber, QSlider,</span><span>
</span><span>                             QVBoxLayout, QApplication)</span><span>
</span><span>
</span><span>
</span><span style=color:#b48ead;>class </span><span style=color:#ebcb8b;>Example</span><span style=color:#eff1f5;>(</span><span style=color:#a3be8c;>QWidget</span><span style=color:#eff1f5;>):</span><span>
</span><span>
</span><span>    </span><span style=color:#b48ead;>def </span><span style=color:#96b5b4;>__init__</span><span>(</span><span style=color:#bf616a;>self</span><span>):</span><span>
</span><span>        </span><span style=color:#96b5b4;>super</span><span>().</span><span style=color:#96b5b4;>__init__</span><span>()</span><span>
</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>initUI</span><span>()</span><span>
</span><span>
</span><span>
</span><span>    </span><span style=color:#b48ead;>def </span><span style=color:#8fa1b3;>initUI</span><span>(</span><span style=color:#bf616a;>self</span><span>):</span><span>
</span><span>
</span><span>        lcd = </span><span style=color:#bf616a;>QLCDNumber</span><span>(</span><span style=color:#bf616a;>self</span><span>)</span><span>
</span><span>        sld = </span><span style=color:#bf616a;>QSlider</span><span>(Qt.Horizontal, </span><span style=color:#bf616a;>self</span><span>)</span><span>
</span><span>
</span><span>        vbox = </span><span style=color:#bf616a;>QVBoxLayout</span><span>()</span><span>
</span><span>        vbox.</span><span style=color:#bf616a;>addWidget</span><span>(lcd)</span><span>
</span><span>        vbox.</span><span style=color:#bf616a;>addWidget</span><span>(sld)</span><span>
</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>setLayout</span><span>(vbox)</span><span>
</span><span>        sld.valueChanged.</span><span style=color:#bf616a;>connect</span><span>(lcd.display)</span><span>
</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>setGeometry</span><span>(</span><span style=color:#d08770;>300</span><span>, </span><span style=color:#d08770;>300</span><span>, </span><span style=color:#d08770;>250</span><span>, </span><span style=color:#d08770;>150</span><span>)</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>setWindowTitle</span><span>('</span><span style=color:#a3be8c;>Signal and slot</span><span>')</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>show</span><span>()</span><span>
</span><span>
</span><span>
</span><span style=color:#b48ead;>def </span><span style=color:#8fa1b3;>main</span><span>():</span><span>
</span><span>    app = </span><span style=color:#bf616a;>QApplication</span><span>(sys.argv)</span><span>
</span><span>    ex = </span><span style=color:#bf616a;>Example</span><span>()</span><span>
</span><span>    sys.</span><span style=color:#bf616a;>exit</span><span>(app.</span><span style=color:#bf616a;>exec_</span><span>())</span><span>
</span><span>
</span><span>
</span><span style=color:#b48ead;>if </span><span>__name__ == '</span><span style=color:#a3be8c;>__main__</span><span>':</span><span>
</span><span>    </span><span style=color:#bf616a;>main</span><span>()</span><span>
</span></code></pre><p>在我们的示例中，我们展示了<code>QtGui.QLCDNumber</code>和<code>QtGui.QSlider</code>部件。我们通过拖动滑块旋钮来更改<code>lcd</code>的数字。<pre style=background-color:#2b303b;color:#c0c5ce;><code><span>sld.valueChanged.connect(lcd.display)</span><span>
</span></code></pre><p>在这里，我们将滑块的<code>valueChanged</code>信号连接到<code>lcd</code>数字的<code>display</code>插槽。<p><strong>发送方是发送信号的对象。接收器是接收信号的对象。插槽是响应信号的方法。</strong><p><img alt=image-20200819141726404 src=Events-and-signals-in-PyQt5/image-20200819141726404.png></p><center>图：信号和插槽</center><h2 id=pyqt5-zhong-xin-shi-xian-shi-jian-chu-li-cheng-xu>PyQt5 重新实现事件处理程序</h2><p>PyQt5 中的事件通常由重新实现的事件处理程序进行处理。<p>reimplement_handler.py<pre class=language-python data-lang=python style=background-color:#2b303b;color:#c0c5ce;><code class=language-python data-lang=python><span style=color:#b48ead;>import </span><span>sys</span><span>
</span><span style=color:#b48ead;>from </span><span>PyQt5.QtCore </span><span style=color:#b48ead;>import </span><span>Qt</span><span>
</span><span style=color:#b48ead;>from </span><span>PyQt5.QtWidgets </span><span style=color:#b48ead;>import </span><span>QWidget, QApplication</span><span>
</span><span>
</span><span>
</span><span style=color:#b48ead;>class </span><span style=color:#ebcb8b;>Example</span><span style=color:#eff1f5;>(</span><span style=color:#a3be8c;>QWidget</span><span style=color:#eff1f5;>):</span><span>
</span><span>
</span><span>    </span><span style=color:#b48ead;>def </span><span style=color:#96b5b4;>__init__</span><span>(</span><span style=color:#bf616a;>self</span><span>):</span><span>
</span><span>        </span><span style=color:#96b5b4;>super</span><span>().</span><span style=color:#96b5b4;>__init__</span><span>()</span><span>
</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>initUI</span><span>()</span><span>
</span><span>
</span><span>    </span><span style=color:#b48ead;>def </span><span style=color:#8fa1b3;>initUI</span><span>(</span><span style=color:#bf616a;>self</span><span>):</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>setGeometry</span><span>(</span><span style=color:#d08770;>300</span><span>, </span><span style=color:#d08770;>300</span><span>, </span><span style=color:#d08770;>250</span><span>, </span><span style=color:#d08770;>150</span><span>)</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>setWindowTitle</span><span>('</span><span style=color:#a3be8c;>Event handler</span><span>')</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>show</span><span>()</span><span>
</span><span>
</span><span>    </span><span style=color:#b48ead;>def </span><span style=color:#8fa1b3;>keyPressEvent</span><span>(</span><span style=color:#bf616a;>self</span><span>, </span><span style=color:#bf616a;>e</span><span>):</span><span>
</span><span>        </span><span style=color:#b48ead;>if </span><span>e.</span><span style=color:#bf616a;>key</span><span>() == Qt.Key_Escape:</span><span>
</span><span>            </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>close</span><span>()</span><span>
</span><span>
</span><span>
</span><span style=color:#b48ead;>def </span><span style=color:#8fa1b3;>main</span><span>():</span><span>
</span><span>    app = </span><span style=color:#bf616a;>QApplication</span><span>(sys.argv)</span><span>
</span><span>    ex = </span><span style=color:#bf616a;>Example</span><span>()</span><span>
</span><span>    sys.</span><span style=color:#bf616a;>exit</span><span>(app.</span><span style=color:#bf616a;>exec_</span><span>())</span><span>
</span><span>
</span><span>
</span><span style=color:#b48ead;>if </span><span>__name__ == '</span><span style=color:#a3be8c;>__main__</span><span>':</span><span>
</span><span>    </span><span style=color:#bf616a;>main</span><span>()</span><span>
</span></code></pre><p>在我们的示例中，我们重新实现事件处理程序<code>keyPressEvent()</code>。<pre style=background-color:#2b303b;color:#c0c5ce;><code><span>def keyPressEvent(self, e):</span><span>
</span><span>
</span><span>    if e.key() == Qt.Key_Escape:</span><span>
</span><span>        self.close()</span><span>
</span></code></pre><p>如果我们单击"Escape“按钮（键盘的ESC键），应用程序将终止。<h2 id=pyqt5-zhong-de-shi-jian-dui-xiang>PyQt5 中的事件对象</h2><p>事件对象是一个 Python 对象，其中包含描述事件的多个属性。事件对象特定于生成的事件类型。<p>event_object.py<pre class=language-python data-lang=python style=background-color:#2b303b;color:#c0c5ce;><code class=language-python data-lang=python><span style=color:#b48ead;>import </span><span>sys</span><span>
</span><span style=color:#b48ead;>from </span><span>PyQt5.QtCore </span><span style=color:#b48ead;>import </span><span>Qt</span><span>
</span><span style=color:#b48ead;>from </span><span>PyQt5.QtWidgets </span><span style=color:#b48ead;>import </span><span>QWidget, QApplication, QGridLayout, QLabel</span><span>
</span><span>
</span><span>
</span><span style=color:#b48ead;>class </span><span style=color:#ebcb8b;>Example</span><span style=color:#eff1f5;>(</span><span style=color:#a3be8c;>QWidget</span><span style=color:#eff1f5;>):</span><span>
</span><span>
</span><span>    </span><span style=color:#b48ead;>def </span><span style=color:#96b5b4;>__init__</span><span>(</span><span style=color:#bf616a;>self</span><span>):</span><span>
</span><span>        </span><span style=color:#96b5b4;>super</span><span>().</span><span style=color:#96b5b4;>__init__</span><span>()</span><span>
</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>initUI</span><span>()</span><span>
</span><span>
</span><span>    </span><span style=color:#b48ead;>def </span><span style=color:#8fa1b3;>initUI</span><span>(</span><span style=color:#bf616a;>self</span><span>):</span><span>
</span><span>        grid = </span><span style=color:#bf616a;>QGridLayout</span><span>()</span><span>
</span><span>
</span><span>        x = </span><span style=color:#d08770;>0</span><span>
</span><span>        y = </span><span style=color:#d08770;>0</span><span>
</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.text = </span><span style=color:#b48ead;>f</span><span>'</span><span style=color:#a3be8c;>x: </span><span>{x}</span><span style=color:#a3be8c;>,  y: </span><span>{y}'</span><span>
</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.label = </span><span style=color:#bf616a;>QLabel</span><span>(</span><span style=color:#bf616a;>self</span><span>.text, </span><span style=color:#bf616a;>self</span><span>)</span><span>
</span><span>        grid.</span><span style=color:#bf616a;>addWidget</span><span>(</span><span style=color:#bf616a;>self</span><span>.label, </span><span style=color:#d08770;>0</span><span>, </span><span style=color:#d08770;>0</span><span>, Qt.AlignTop)</span><span>
</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>setMouseTracking</span><span>(</span><span style=color:#d08770;>True</span><span>)</span><span>
</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>setLayout</span><span>(grid)</span><span>
</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>setGeometry</span><span>(</span><span style=color:#d08770;>300</span><span>, </span><span style=color:#d08770;>300</span><span>, </span><span style=color:#d08770;>450</span><span>, </span><span style=color:#d08770;>300</span><span>)</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>setWindowTitle</span><span>('</span><span style=color:#a3be8c;>Event object</span><span>')</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>show</span><span>()</span><span>
</span><span>
</span><span>    </span><span style=color:#b48ead;>def </span><span style=color:#8fa1b3;>mouseMoveEvent</span><span>(</span><span style=color:#bf616a;>self</span><span>, </span><span style=color:#bf616a;>e</span><span>):</span><span>
</span><span>        x = e.</span><span style=color:#bf616a;>x</span><span>()</span><span>
</span><span>        y = e.</span><span style=color:#bf616a;>y</span><span>()</span><span>
</span><span>
</span><span>        text = </span><span style=color:#b48ead;>f</span><span>'</span><span style=color:#a3be8c;>x: </span><span>{x}</span><span style=color:#a3be8c;>,  y: </span><span>{y}'</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.label.</span><span style=color:#bf616a;>setText</span><span>(text)</span><span>
</span><span>
</span><span>
</span><span style=color:#b48ead;>def </span><span style=color:#8fa1b3;>main</span><span>():</span><span>
</span><span>    app = </span><span style=color:#bf616a;>QApplication</span><span>(sys.argv)</span><span>
</span><span>    ex = </span><span style=color:#bf616a;>Example</span><span>()</span><span>
</span><span>    sys.</span><span style=color:#bf616a;>exit</span><span>(app.</span><span style=color:#bf616a;>exec_</span><span>())</span><span>
</span><span>
</span><span>
</span><span style=color:#b48ead;>if </span><span>__name__ == '</span><span style=color:#a3be8c;>__main__</span><span>':</span><span>
</span><span>    </span><span style=color:#bf616a;>main</span><span>()</span><span>
</span></code></pre><p>在此示例中，我们在标签部件中显示鼠标指针的 x 和 y 坐标。<pre style=background-color:#2b303b;color:#c0c5ce;><code><span>self.text = f'x: {x},  y: {y}'</span><span>
</span><span>
</span><span>self.label = QLabel(self.text, self)</span><span>
</span></code></pre><p>x 和 y 坐标显示在<code>QLabel</code>部件中。<pre style=background-color:#2b303b;color:#c0c5ce;><code><span>self.setMouseTracking(True)</span><span>
</span></code></pre><p>默认情况下，鼠标跟踪处于禁用状态，因此部件仅在移动鼠标时至少按下一个鼠标按钮时才收到鼠标移动事件。如果启用鼠标跟踪，则即使未按下任何按钮，部件也将收到鼠标移动事件。<pre style=background-color:#2b303b;color:#c0c5ce;><code><span>def mouseMoveEvent(self, e):</span><span>
</span><span>
</span><span>    x = e.x()</span><span>
</span><span>    y = e.y()</span><span>
</span><span>
</span><span>    text = f'x: {x},  y: {y}'</span><span>
</span><span>    self.label.setText(text)</span><span>
</span></code></pre><p><code>e</code>是事件对象，它包含有关触发事件的数据。在我们的案例中，<code>e</code>是鼠标移动事件。使用<code>x()</code>和<code>y()</code>方法，我们确定鼠标指针的 x 和 y 坐标。我们生成字符串并设置为标签部件的内容。<p><img alt=image-20200819142642009 src=Events-and-signals-in-PyQt5/image-20200819142642009.png></p><center>图：事件对象</center><h2 id=pyqt5-shi-jian-fa-song-zhe>PyQt5 事件发送者</h2><p>有时，知道哪个部件是信号的发送者是很方便的。为此，PyQt5 具有<code>sender</code>方法。<p>event_sender.py<pre class=language-python data-lang=python style=background-color:#2b303b;color:#c0c5ce;><code class=language-python data-lang=python><span style=color:#b48ead;>import </span><span>sys</span><span>
</span><span style=color:#b48ead;>from </span><span>PyQt5.QtWidgets </span><span style=color:#b48ead;>import </span><span>QMainWindow, QPushButton, QApplication</span><span>
</span><span>
</span><span>
</span><span style=color:#b48ead;>class </span><span style=color:#ebcb8b;>Example</span><span style=color:#eff1f5;>(</span><span style=color:#a3be8c;>QMainWindow</span><span style=color:#eff1f5;>):</span><span>
</span><span>
</span><span>    </span><span style=color:#b48ead;>def </span><span style=color:#96b5b4;>__init__</span><span>(</span><span style=color:#bf616a;>self</span><span>):</span><span>
</span><span>        </span><span style=color:#96b5b4;>super</span><span>().</span><span style=color:#96b5b4;>__init__</span><span>()</span><span>
</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>initUI</span><span>()</span><span>
</span><span>
</span><span>    </span><span style=color:#b48ead;>def </span><span style=color:#8fa1b3;>initUI</span><span>(</span><span style=color:#bf616a;>self</span><span>):</span><span>
</span><span>        btn1 = </span><span style=color:#bf616a;>QPushButton</span><span>("</span><span style=color:#a3be8c;>Button 1</span><span>", </span><span style=color:#bf616a;>self</span><span>)</span><span>
</span><span>        btn1.</span><span style=color:#bf616a;>move</span><span>(</span><span style=color:#d08770;>30</span><span>, </span><span style=color:#d08770;>50</span><span>)</span><span>
</span><span>
</span><span>        btn2 = </span><span style=color:#bf616a;>QPushButton</span><span>("</span><span style=color:#a3be8c;>Button 2</span><span>", </span><span style=color:#bf616a;>self</span><span>)</span><span>
</span><span>        btn2.</span><span style=color:#bf616a;>move</span><span>(</span><span style=color:#d08770;>150</span><span>, </span><span style=color:#d08770;>50</span><span>)</span><span>
</span><span>
</span><span>        btn1.clicked.</span><span style=color:#bf616a;>connect</span><span>(</span><span style=color:#bf616a;>self</span><span>.buttonClicked)</span><span>
</span><span>        btn2.clicked.</span><span style=color:#bf616a;>connect</span><span>(</span><span style=color:#bf616a;>self</span><span>.buttonClicked)</span><span>
</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>statusBar</span><span>()</span><span>
</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>setGeometry</span><span>(</span><span style=color:#d08770;>300</span><span>, </span><span style=color:#d08770;>300</span><span>, </span><span style=color:#d08770;>450</span><span>, </span><span style=color:#d08770;>350</span><span>)</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>setWindowTitle</span><span>('</span><span style=color:#a3be8c;>Event sender</span><span>')</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>show</span><span>()</span><span>
</span><span>
</span><span>    </span><span style=color:#b48ead;>def </span><span style=color:#8fa1b3;>buttonClicked</span><span>(</span><span style=color:#bf616a;>self</span><span>):</span><span>
</span><span>        sender = </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>sender</span><span>()</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>statusBar</span><span>().</span><span style=color:#bf616a;>showMessage</span><span>(sender.</span><span style=color:#bf616a;>text</span><span>() + '</span><span style=color:#a3be8c;> was pressed</span><span>')</span><span>
</span><span>
</span><span>
</span><span style=color:#b48ead;>def </span><span style=color:#8fa1b3;>main</span><span>():</span><span>
</span><span>    app = </span><span style=color:#bf616a;>QApplication</span><span>(sys.argv)</span><span>
</span><span>    ex = </span><span style=color:#bf616a;>Example</span><span>()</span><span>
</span><span>    sys.</span><span style=color:#bf616a;>exit</span><span>(app.</span><span style=color:#bf616a;>exec_</span><span>())</span><span>
</span><span>
</span><span>
</span><span style=color:#b48ead;>if </span><span>__name__ == '</span><span style=color:#a3be8c;>__main__</span><span>':</span><span>
</span><span>    </span><span style=color:#bf616a;>main</span><span>()</span><span>
</span></code></pre><p>我们的示例有两个按钮。在<code>buttonClicked</code>方法中，我们通过调用<code>sender()</code>方法确定单击的按钮。<pre style=background-color:#2b303b;color:#c0c5ce;><code><span>btn1.clicked.connect(self.buttonClicked)</span><span>
</span><span>btn2.clicked.connect(self.buttonClicked)</span><span>
</span></code></pre><p>两个按钮都连接到同一插槽。<pre style=background-color:#2b303b;color:#c0c5ce;><code><span>def buttonClicked(self):</span><span>
</span><span>
</span><span>    sender = self.sender()</span><span>
</span><span>    self.statusBar().showMessage(sender.text() + ' was pressed')</span><span>
</span></code></pre><p>我们通过调用<code>sender()</code>方法确定信号源。在应用程序的状态栏中，我们显示按下按钮的标签。<p><img alt=image-20200819143108993 src=Events-and-signals-in-PyQt5/image-20200819143108993.png></p><center>图：事件发送者</center><h2 id=pyqt5-fa-she-xin-hao>PyQt5 发射信号</h2><p>从<code>QObject</code>中创建的对象可以发出信号。下面的示例演示我们如何发出自定义信号。<p>custom_signal.py<pre class=language-python data-lang=python style=background-color:#2b303b;color:#c0c5ce;><code class=language-python data-lang=python><span style=color:#b48ead;>import </span><span>sys</span><span>
</span><span style=color:#b48ead;>from </span><span>PyQt5.QtCore </span><span style=color:#b48ead;>import </span><span>pyqtSignal, QObject</span><span>
</span><span style=color:#b48ead;>from </span><span>PyQt5.QtWidgets </span><span style=color:#b48ead;>import </span><span>QMainWindow, QApplication</span><span>
</span><span>
</span><span>
</span><span style=color:#b48ead;>class </span><span style=color:#ebcb8b;>Communicate</span><span style=color:#eff1f5;>(</span><span style=color:#a3be8c;>QObject</span><span style=color:#eff1f5;>):</span><span>
</span><span>
</span><span>    closeApp = </span><span style=color:#bf616a;>pyqtSignal</span><span>()</span><span>
</span><span>
</span><span>
</span><span style=color:#b48ead;>class </span><span style=color:#ebcb8b;>Example</span><span style=color:#eff1f5;>(</span><span style=color:#a3be8c;>QMainWindow</span><span style=color:#eff1f5;>):</span><span>
</span><span>
</span><span>    </span><span style=color:#b48ead;>def </span><span style=color:#96b5b4;>__init__</span><span>(</span><span style=color:#bf616a;>self</span><span>):</span><span>
</span><span>        </span><span style=color:#96b5b4;>super</span><span>().</span><span style=color:#96b5b4;>__init__</span><span>()</span><span>
</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>initUI</span><span>()</span><span>
</span><span>
</span><span>    </span><span style=color:#b48ead;>def </span><span style=color:#8fa1b3;>initUI</span><span>(</span><span style=color:#bf616a;>self</span><span>):</span><span>
</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.c = </span><span style=color:#bf616a;>Communicate</span><span>()</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.c.closeApp.</span><span style=color:#bf616a;>connect</span><span>(</span><span style=color:#bf616a;>self</span><span>.close)</span><span>
</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>setGeometry</span><span>(</span><span style=color:#d08770;>300</span><span>, </span><span style=color:#d08770;>300</span><span>, </span><span style=color:#d08770;>450</span><span>, </span><span style=color:#d08770;>350</span><span>)</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>setWindowTitle</span><span>('</span><span style=color:#a3be8c;>Emit signal</span><span>')</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>show</span><span>()</span><span>
</span><span>
</span><span>    </span><span style=color:#b48ead;>def </span><span style=color:#8fa1b3;>mousePressEvent</span><span>(</span><span style=color:#bf616a;>self</span><span>, </span><span style=color:#bf616a;>event</span><span>):</span><span>
</span><span>
</span><span>        </span><span style=color:#bf616a;>self</span><span>.c.closeApp.</span><span style=color:#bf616a;>emit</span><span>()</span><span>
</span><span>
</span><span>
</span><span style=color:#b48ead;>def </span><span style=color:#8fa1b3;>main</span><span>():</span><span>
</span><span>    app = </span><span style=color:#bf616a;>QApplication</span><span>(sys.argv)</span><span>
</span><span>    ex = </span><span style=color:#bf616a;>Example</span><span>()</span><span>
</span><span>    sys.</span><span style=color:#bf616a;>exit</span><span>(app.</span><span style=color:#bf616a;>exec_</span><span>())</span><span>
</span><span>
</span><span>
</span><span style=color:#b48ead;>if </span><span>__name__ == '</span><span style=color:#a3be8c;>__main__</span><span>':</span><span>
</span><span>    </span><span style=color:#bf616a;>main</span><span>()</span><span>
</span></code></pre><p>我们创建一个名为<code>closeApp</code>的新信号。此信号在鼠标按下事件期间发出。信号连接到<code>QMainWindow</code>的<code>close()</code>插槽。<pre style=background-color:#2b303b;color:#c0c5ce;><code><span>class Communicate(QObject):</span><span>
</span><span>
</span><span>    closeApp = pyqtSignal()</span><span>
</span></code></pre><p>使用<code>pyqtSignal()</code>作为外部类<code>Communicate</code>的类属性创建信号。<pre style=background-color:#2b303b;color:#c0c5ce;><code><span>self.c = Communicate()</span><span>
</span><span>self.c.closeApp.connect(self.close)</span><span>
</span></code></pre><p>自定义<code>closeApp</code>信号连接到<code>QMainWindow</code>的<code>close()</code>插槽。<pre style=background-color:#2b303b;color:#c0c5ce;><code><span>def mousePressEvent(self, event):</span><span>
</span><span>
</span><span>    self.c.closeApp.emit()</span><span>
</span></code></pre><p>当我们用鼠标指针单击窗口时，<code>closeApp</code>信号会发出。应用程序终止。<p>在 PyQt5 教程的这一部分中，我们介绍了信号和插槽。</div></div></div><footer class=footer__poweredby><p class=caption>© 2022 All Rights Reserved modao::rustacean@aliyun.com<p class=caption>© Powered by <a href=https://www.getzola.org/>Zola</a><p class=caption>© Theme: <a href=https://github.com/pawroman/zola-theme-terminimal/>Terminimal</a> by pawroman<p class=caption><a href=https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh rel=license>自由转载-非商用-非衍生-保持署名</a></footer></div>