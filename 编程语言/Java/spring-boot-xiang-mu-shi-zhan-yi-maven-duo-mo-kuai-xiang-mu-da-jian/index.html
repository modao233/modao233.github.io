<!doctype html><html lang=zh-Hans-CN><head><title>modao's blog</title><meta content="text/html; charset=utf-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1.0,maximum-scale=1" name=viewport><meta content=noodp name=robots><link href=https://modao.site/style.css rel=stylesheet><link href=https://modao.site/color/green.css rel=stylesheet><link href=https://modao.site/color/background_dark.css rel=stylesheet><link href=https://modao.site/font-hack.css rel=stylesheet><body><div class=container><header class=header><div class=header__inner><div class=header__logo><a style="text-decoration: none;" href=https://modao.site> <div class=logo>MODAO</div> </a></div></div><nav class=menu><ul class=menu__inner><li class=active><a href=https://modao.site>Home</a><li><a href=https://modao.site/tags>Tags</a><li><a href=https://modao.site/language>Programming-Language</a><li><a href=https://modao.site/books>Books</a><li><a href=https://modao.site/links>Links</a><li><a href=https://modao.site/friend>Friend</a></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=https://modao.site/编程语言/Java/spring-boot-xiang-mu-shi-zhan-yi-maven-duo-mo-kuai-xiang-mu-da-jian/>Spring Boot 项目实战（一）Maven 多模块项目搭建</a></h1><div class=post-meta-inline><span class=post-date> 2021-01-13 </span></div><div class=post-content><p>原文：https://www.cnblogs.com/orzlin/p/10330163.html<h2 id=huan-jing>环境</h2><ul><li>win10<li>IDEA 2020.2<li>JDK 1.8<li>Maven 3.6.3<li>Spring Boot</ul><h2 id=xiang-mu-jie-gou>项目结构</h2><ul><li>biz 层（业务逻辑层）<li>dao 层（数据持久层）<li>common 层（公用组件层）<li>web 层（请求处理层）</ul><blockquote><p>注：biz 层依赖 dao 及 common 层， web 层依赖 biz 层</blockquote><h2 id=xiang-mu-da-jian>项目搭建</h2><h3 id=chuang-jian-fu-gong-cheng>创建父工程</h3><ol><li><p>IDEA 主面板选择菜单「Create New Project 」或者工具栏选择菜单「 File -> New -> Project... 」![image-20210112231629069](Spring Boot 项目实战（一）Maven 多模块项目搭建/image-20210112231629069.png)</p><li><p>侧边栏选择「 Spring Initializr 」，Initializr 默认选择 Default ，然后点击「 Next 」</p> <p>![image-20210112231823448](Spring Boot 项目实战（一）Maven 多模块项目搭建/image-20210112231823448.png)</p><li><p>修改 Group 、 Artifact 、 Package 输入框中的值后点击「 Next 」</p> <p>![image-20210112232037894](Spring Boot 项目实战（一）Maven 多模块项目搭建/image-20210112232037894.png)</p> <ul><li>GroupID 是项目组织唯一的标识符，实际对应JAVA的包的结构，是main目录里java的目录结构。<li>ArtifactID是项目的唯一的标识符，实际对应项目的名称，就是项目根目录的名称。<li>命名规则：如果要把项目弄到maven本地仓库中，那项目就必须指定唯一的坐标，即指定唯一的GroupD和ArtifactID <ul><li>GroupId一般分为多个段，第一段为域，第二段为公司名称。域又分为org、com、cn等等许多，其中org为非营利组织，com为商业组织。举个apache公司的tomcat项目例子：这个项目的GroupId是org.apache，它的域是org（因为tomcat是非营利项目），公司名称是apache，ArtifactId是tomcat。<li>ArtifactId 是项目名称，比如：apache的tomcat项目</ul></ul><li><p>这步暂时先不需要选择，直接点「 Next 」</p> <p>![image-20210112232256095](Spring Boot 项目实战（一）Maven 多模块项目搭建/image-20210112232256095.png)</p><li><p>点击「 Finish 」创建项目</p> <p>![image-20210112232353297](Spring Boot 项目实战（一）Maven 多模块项目搭建/image-20210112232353297.png)</p><li><p>最终得到的项目目录结构如下</p> <pre style=background-color:#2b303b;color:#c0c5ce;><code><span>|-- demo
</span><span>  |-- .gitignore
</span><span>  |-- mvnw
</span><span>  |-- mvnw.cmd
</span><span>  |-- pom.xml
</span><span>  |-- .mvn
</span><span>  |   |-- wrapper
</span><span>  | |-- maven-wrapper.jar
</span><span>  | |-- maven-wrapper.properties
</span><span>  |-- src
</span><span>|-- main
</span><span>|   |-- java
</span><span>|   |   |-- com
</span><span>|   | |-- modao
</span><span>|   |     |-- demo
</span><span>|   |   |-- DemoApplication.java
</span><span>|   |-- resources
</span><span>| |-- application.properties
</span><span>|-- test
</span><span>    |-- java
</span><span>  |-- com
</span><span>|-- modao
</span><span>    |-- demo
</span><span>  |-- DemoApplicationTests.java
</span></code></pre> <p>![image-20210112232649102](Spring Boot 项目实战（一）Maven 多模块项目搭建/image-20210112232649102.png)</p><li><p>删除无用的 .mvn 目录、 src 目录、 mvnw 及 mvnw.cmd 文件，最终只留 .gitignore 和 pom.xml</p></ol><h3 id=chuang-jian-zi-mo-kuai>创建子模块</h3><ol><li><p>选择项目根目录，右键呼出菜单，选择「 New -> Module 」![image-20210112232801176](Spring Boot 项目实战（一）Maven 多模块项目搭建/image-20210112232801176.png)</p><li><p>侧边栏选择「 Maven 」，点击「 Next 」![image-20210112232829256](Spring Boot 项目实战（一）Maven 多模块项目搭建/image-20210112232829256.png)</p><li><p>填写 Name，点击「 Finish 」![image-20210112232924688](Spring Boot 项目实战（一）Maven 多模块项目搭建/image-20210112232924688.png)</p><li><p>同理添加「 dao 」、「 common 」、「 web 」子模块，最终得到项目目录结构如下</p> <pre style=background-color:#2b303b;color:#c0c5ce;><code><span>demo/
</span><span>├── biz
</span><span>│   ├── biz.iml
</span><span>│   ├── pom.xml
</span><span>│   └── src
</span><span>│       ├── main
</span><span>│       │   ├── java
</span><span>│       │   └── resources
</span><span>│       └── test
</span><span>│     └── java
</span><span>├── common
</span><span>│   ├── common.iml
</span><span>│   ├── pom.xml
</span><span>│   └── src
</span><span>│       ├── main
</span><span>│       │   ├── java
</span><span>│       │   └── resources
</span><span>│       └── test
</span><span>│     └── java
</span><span>├── dao
</span><span>│   ├── dao.iml
</span><span>│   ├── pom.xml
</span><span>│   └── src
</span><span>│       ├── main
</span><span>│       │   ├── java
</span><span>│       │   └── resources
</span><span>│       └── test
</span><span>│     └── java
</span><span>├── demo.iml
</span><span>├── pom.xml
</span><span>└── web
</span><span>    ├── pom.xml
</span><span>    ├── src
</span><span>    │   ├── main
</span><span>    │   │   ├── java
</span><span>    │   │   └── resources
</span><span>    │   └── test
</span><span>    │       └── java
</span><span>    └── web.iml
</span></code></pre></ol><h3 id=zheng-li-fu-pom-wen-jian-zhong-de-nei-rong>整理父 pom 文件中的内容</h3><ol><li><p>删除 dependencies 标签及其中的 spring-boot-starter 和 spring-boot-starter-test 依赖，因为 Spring Boot 提供的父工程已包含，并且父 pom 原则上都是通过 dependencyManagement 标签管理依赖包。</p> <blockquote><p>注：dependencyManagement 及 dependencies 的区别自行查阅文档</blockquote><li><p>删除 build 标签及其中的所有内容，spring-boot-maven-plugin 插件作用是打一个可运行的包，多模块项目仅仅需要在入口类所在的模块添加打包插件，这里父模块不需要打包运行。而且该插件已被包含在 Spring Boot 提供的父工程中，这里删掉即可。</p><li><p>最后整理父 pom 文件中的其余内容，按其代表含义归类，整理结果如下：</p> <pre class=language-xml data-lang=xml style=background-color:#2b303b;color:#c0c5ce;><code class=language-xml data-lang=xml><span>&LT?</span><span style=color:#bf616a;>xml </span><span style=color:#d08770;>version</span><span>="</span><span style=color:#a3be8c;>1.0</span><span>" </span><span style=color:#d08770;>encoding</span><span>="</span><span style=color:#a3be8c;>UTF-8</span><span>"?>
</span><span><</span><span style=color:#bf616a;>project </span><span style=color:#d08770;>xmlns</span><span>="</span><span style=color:#a3be8c;>http://maven.apache.org/POM/4.0.0</span><span>" </span><span style=color:#d08770;>xmlns:xsi</span><span>="</span><span style=color:#a3be8c;>http://www.w3.org/2001/XMLSchema-instance</span><span>"
</span><span>   </span><span style=color:#d08770;>xsi:schemaLocation</span><span>="</span><span style=color:#a3be8c;>http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd</span><span>">
</span><span>  <</span><span style=color:#bf616a;>modelVersion</span><span>>4.0.0&LT/</span><span style=color:#bf616a;>modelVersion</span><span>>
</span><span>  <</span><span style=color:#bf616a;>groupId</span><span>>com.modao&LT/</span><span style=color:#bf616a;>groupId</span><span>>
</span><span>  <</span><span style=color:#bf616a;>artifactId</span><span>>demo&LT/</span><span style=color:#bf616a;>artifactId</span><span>>
</span><span>  <</span><span style=color:#bf616a;>packaging</span><span>>pom&LT/</span><span style=color:#bf616a;>packaging</span><span>>
</span><span>  <</span><span style=color:#bf616a;>version</span><span>>0.0.1-SNAPSHOT&LT/</span><span style=color:#bf616a;>version</span><span>>
</span><span>  <</span><span style=color:#bf616a;>modules</span><span>>
</span><span>    <</span><span style=color:#bf616a;>module</span><span>>biz&LT/</span><span style=color:#bf616a;>module</span><span>>
</span><span>    <</span><span style=color:#bf616a;>module</span><span>>dao&LT/</span><span style=color:#bf616a;>module</span><span>>
</span><span>    <</span><span style=color:#bf616a;>module</span><span>>common&LT/</span><span style=color:#bf616a;>module</span><span>>
</span><span>    <</span><span style=color:#bf616a;>module</span><span>>web&LT/</span><span style=color:#bf616a;>module</span><span>>
</span><span>  &LT/</span><span style=color:#bf616a;>modules</span><span>>
</span><span>  <</span><span style=color:#bf616a;>name</span><span>>demo&LT/</span><span style=color:#bf616a;>name</span><span>>
</span><span>  <</span><span style=color:#bf616a;>description</span><span>>Demo project for Spring Boot&LT/</span><span style=color:#bf616a;>description</span><span>>
</span><span>
</span><span>  <</span><span style=color:#bf616a;>properties</span><span>>
</span><span>    <</span><span style=color:#bf616a;>java.version</span><span>>1.8&LT/</span><span style=color:#bf616a;>java.version</span><span>>
</span><span>    <</span><span style=color:#bf616a;>project.build.sourceEncoding</span><span>>UTF-8&LT/</span><span style=color:#bf616a;>project.build.sourceEncoding</span><span>>
</span><span>    <</span><span style=color:#bf616a;>project.reporting.outputEncoding</span><span>>UTF-8&LT/</span><span style=color:#bf616a;>project.reporting.outputEncoding</span><span>>
</span><span>    <</span><span style=color:#bf616a;>spring-boot.version</span><span>>2.3.7.RELEASE&LT/</span><span style=color:#bf616a;>spring-boot.version</span><span>>
</span><span>  &LT/</span><span style=color:#bf616a;>properties</span><span>>
</span><span>
</span><span>  <</span><span style=color:#bf616a;>parent</span><span>>
</span><span>    <</span><span style=color:#bf616a;>artifactId</span><span>>spring-boot-starter-parent&LT/</span><span style=color:#bf616a;>artifactId</span><span>>
</span><span>    <</span><span style=color:#bf616a;>groupId</span><span>>org.springframework.boot&LT/</span><span style=color:#bf616a;>groupId</span><span>>
</span><span>    <</span><span style=color:#bf616a;>version</span><span>>2.3.7.RELEASE&LT/</span><span style=color:#bf616a;>version</span><span>>
</span><span>  &LT/</span><span style=color:#bf616a;>parent</span><span>>
</span><span>
</span><span>&LT/</span><span style=color:#bf616a;>project</span><span>>
</span></code></pre></ol><h3 id=jian-yi-http-jie-kou-ce-shi>简易 HTTP 接口测试</h3><p>准备工作都完成之后，通过一个简易的 HTTP 接口测试项目是否正常运行。<ol><li><p>首先在 web 模块的java目录下创建 com.modao.demo.web 包并添加入口类 DemoWebApplication.java</p> <pre class=language-java data-lang=java style=background-color:#2b303b;color:#c0c5ce;><code class=language-java data-lang=java><span style=color:#b48ead;>package </span><span>com.modao.demo.web;
</span><span>
</span><span style=color:#b48ead;>import </span><span>org.springframework.boot.</span><span style=color:#ebcb8b;>SpringApplication</span><span>;
</span><span style=color:#b48ead;>import </span><span>org.springframework.boot.autoconfigure.</span><span style=color:#ebcb8b;>SpringBootApplication</span><span>;
</span><span>
</span><span>
</span><span>@</span><span style=color:#bf616a;>SpringBootApplication
</span><span style=color:#b48ead;>public class </span><span style=color:#ebcb8b;>DemoWebApplication </span><span style=color:#eff1f5;>{
</span><span style=color:#eff1f5;>    </span><span style=color:#b48ead;>public static void </span><span style=color:#8fa1b3;>main</span><span style=color:#eff1f5;>(</span><span style=color:#ebcb8b;>String</span><span style=color:#b48ead;>[] </span><span style=color:#bf616a;>args</span><span style=color:#eff1f5;>) {
</span><span style=color:#eff1f5;>  </span><span style=color:#ebcb8b;>SpringApplication</span><span style=color:#eff1f5;>.</span><span style=color:#bf616a;>run</span><span style=color:#eff1f5;>(</span><span style=color:#ebcb8b;>DemoWebApplication</span><span style=color:#eff1f5;>.</span><span style=color:#bf616a;>class</span><span style=color:#eff1f5;>, args);
</span><span style=color:#eff1f5;>    }
</span><span style=color:#eff1f5;>}
</span></code></pre><li><p>其次在 web 层的 pom 文件中添加必要的依赖包</p> <pre class=language-xml data-lang=xml style=background-color:#2b303b;color:#c0c5ce;><code class=language-xml data-lang=xml><span><</span><span style=color:#bf616a;>dependencies</span><span>>
</span><span>    <</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>  <</span><span style=color:#bf616a;>groupId</span><span>>org.springframework.boot&LT/</span><span style=color:#bf616a;>groupId</span><span>>
</span><span>  <</span><span style=color:#bf616a;>artifactId</span><span>>spring-boot-starter-web&LT/</span><span style=color:#bf616a;>artifactId</span><span>>
</span><span>    &LT/</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>&LT/</span><span style=color:#bf616a;>dependencies</span><span>>
</span></code></pre><li><p>然后在 com.modao.demo.web 包中添加 controller 目录并新建一个 DemoController.java，添加 test 方法测试接口是否可以正常访问。</p> <pre class=language-java data-lang=java style=background-color:#2b303b;color:#c0c5ce;><code class=language-java data-lang=java><span style=color:#b48ead;>package </span><span>com.modao.demo.web.controller;
</span><span>
</span><span style=color:#b48ead;>import </span><span>org.springframework.web.bind.annotation.</span><span style=color:#ebcb8b;>GetMapping</span><span>;
</span><span style=color:#b48ead;>import </span><span>org.springframework.web.bind.annotation.</span><span style=color:#ebcb8b;>RequestMapping</span><span>;
</span><span style=color:#b48ead;>import </span><span>org.springframework.web.bind.annotation.</span><span style=color:#ebcb8b;>RestController</span><span>;
</span><span>
</span><span>@</span><span style=color:#bf616a;>RestController
</span><span>@</span><span style=color:#bf616a;>RequestMapping</span><span>("</span><span style=color:#a3be8c;>demo</span><span>")
</span><span style=color:#b48ead;>public class </span><span style=color:#ebcb8b;>DemoController </span><span style=color:#eff1f5;>{
</span><span style=color:#eff1f5;>
</span><span style=color:#eff1f5;>    @</span><span style=color:#bf616a;>GetMapping</span><span style=color:#eff1f5;>(</span><span>"</span><span style=color:#a3be8c;>test</span><span>"</span><span style=color:#eff1f5;>)
</span><span style=color:#eff1f5;>    </span><span style=color:#b48ead;>public </span><span style=color:#ebcb8b;>String </span><span style=color:#8fa1b3;>test</span><span style=color:#eff1f5;>() {
</span><span style=color:#eff1f5;>  </span><span style=color:#b48ead;>return </span><span>"</span><span style=color:#a3be8c;>Hello World!</span><span>"</span><span style=color:#eff1f5;>;
</span><span style=color:#eff1f5;>    }
</span><span style=color:#eff1f5;>}
</span></code></pre><li><p>最后运行 DemoWebApplication 类中的 main 方法启动项目，默认端口为 8080，访问 http://localhost:8080/demo/test 即可测试接口</p> <p>![image-20210112234543606](Spring Boot 项目实战（一）Maven 多模块项目搭建/image-20210112234543606.png)</p></ol><h3 id=pei-zhi-mo-kuai-jian-de-yi-lai-guan-xi>配置模块间的依赖关系</h3><p>通常 JAVA Web 项目会按照功能划分不同模块，模块之间通过依赖关系进行协作，下面将完善模块之间的依赖关系。<ol><li><p>首先在父 pom 文件中使用「 dependencyManagement 」标签声明所有子模块依赖</p> <pre class=language-xml data-lang=xml style=background-color:#2b303b;color:#c0c5ce;><code class=language-xml data-lang=xml><span style=color:#65737e;>&LT!-- 依赖管理：这里统一管理依赖的版本号 -->
</span><span><</span><span style=color:#bf616a;>dependencyManagement</span><span>>
</span><span>  <</span><span style=color:#bf616a;>dependencies</span><span>>
</span><span>    <</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>      <</span><span style=color:#bf616a;>groupId</span><span>>com.modao&LT/</span><span style=color:#bf616a;>groupId</span><span>>
</span><span>      <</span><span style=color:#bf616a;>artifactId</span><span>>biz&LT/</span><span style=color:#bf616a;>artifactId</span><span>>
</span><span>      <</span><span style=color:#bf616a;>version</span><span>>0.0.1-SNAPSHOT&LT/</span><span style=color:#bf616a;>version</span><span>>
</span><span>    &LT/</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>    <</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>      <</span><span style=color:#bf616a;>groupId</span><span>>com.modao&LT/</span><span style=color:#bf616a;>groupId</span><span>>
</span><span>      <</span><span style=color:#bf616a;>artifactId</span><span>>common&LT/</span><span style=color:#bf616a;>artifactId</span><span>>
</span><span>      <</span><span style=color:#bf616a;>version</span><span>>0.0.1-SNAPSHOT&LT/</span><span style=color:#bf616a;>version</span><span>>
</span><span>    &LT/</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>    <</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>      <</span><span style=color:#bf616a;>groupId</span><span>>com.modao&LT/</span><span style=color:#bf616a;>groupId</span><span>>
</span><span>      <</span><span style=color:#bf616a;>artifactId</span><span>>dao&LT/</span><span style=color:#bf616a;>artifactId</span><span>>
</span><span>      <</span><span style=color:#bf616a;>version</span><span>>0.0.1-SNAPSHOT&LT/</span><span style=color:#bf616a;>version</span><span>>
</span><span>    &LT/</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>    <</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>      <</span><span style=color:#bf616a;>groupId</span><span>>com.modao&LT/</span><span style=color:#bf616a;>groupId</span><span>>
</span><span>      <</span><span style=color:#bf616a;>artifactId</span><span>>web&LT/</span><span style=color:#bf616a;>artifactId</span><span>>
</span><span>      <</span><span style=color:#bf616a;>version</span><span>>0.0.1-SNAPSHOT&LT/</span><span style=color:#bf616a;>version</span><span>>
</span><span>    &LT/</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>  &LT/</span><span style=color:#bf616a;>dependencies</span><span>>
</span><span>&LT/</span><span style=color:#bf616a;>dependencyManagement</span><span>>
</span></code></pre><li><p>其次在 biz 层中的 pom 文件中添加 dao 及 common 依赖</p> <pre class=language-xml data-lang=xml style=background-color:#2b303b;color:#c0c5ce;><code class=language-xml data-lang=xml><span><</span><span style=color:#bf616a;>dependencies</span><span>>
</span><span>  <</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>    <</span><span style=color:#bf616a;>groupId</span><span>>com.modao&LT/</span><span style=color:#bf616a;>groupId</span><span>>
</span><span>    <</span><span style=color:#bf616a;>artifactId</span><span>>common&LT/</span><span style=color:#bf616a;>artifactId</span><span>>
</span><span>  &LT/</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>  <</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>    <</span><span style=color:#bf616a;>groupId</span><span>>com.modao&LT/</span><span style=color:#bf616a;>groupId</span><span>>
</span><span>    <</span><span style=color:#bf616a;>artifactId</span><span>>dao&LT/</span><span style=color:#bf616a;>artifactId</span><span>>
</span><span>  &LT/</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>&LT/</span><span style=color:#bf616a;>dependencies</span><span>>
</span></code></pre><li><p>之后在 demo-web 层中的 pom 文件中添加 demo-biz 依赖</p> <pre class=language-xml data-lang=xml style=background-color:#2b303b;color:#c0c5ce;><code class=language-xml data-lang=xml><span>  <</span><span style=color:#bf616a;>dependencies</span><span>>
</span><span>    <</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>      <</span><span style=color:#bf616a;>groupId</span><span>>org.springframework.boot&LT/</span><span style=color:#bf616a;>groupId</span><span>>
</span><span>      <</span><span style=color:#bf616a;>artifactId</span><span>>spring-boot-starter-web&LT/</span><span style=color:#bf616a;>artifactId</span><span>>
</span><span>    &LT/</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>    <</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>      <</span><span style=color:#bf616a;>groupId</span><span>>com.modao&LT/</span><span style=color:#bf616a;>groupId</span><span>>
</span><span>      <</span><span style=color:#bf616a;>artifactId</span><span>>biz&LT/</span><span style=color:#bf616a;>artifactId</span><span>>
</span><span>    &LT/</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>  &LT/</span><span style=color:#bf616a;>dependencies</span><span>>
</span></code></pre></ol><h3 id=web-ceng-diao-yong-biz-ceng-jie-kou-ce-shi>web 层调用 biz 层接口测试</h3><p>模块依赖关系配置完成之后，通过 web 层 测试下 biz 层的接口是否可以正常调用。<ol><li><p>首先在 biz 模块的java目录里创建 com.modao.demo.biz 包，添加 service 目录并在其中创建 DemoService 接口类及 impl 目录（用于存放接口实现类）。</p> <pre class=language-java data-lang=java style=background-color:#2b303b;color:#c0c5ce;><code class=language-java data-lang=java><span style=color:#b48ead;>package </span><span>com.modao.demo.biz;
</span><span>
</span><span style=color:#b48ead;>public interface </span><span style=color:#ebcb8b;>DemoService </span><span style=color:#eff1f5;>{
</span><span style=color:#eff1f5;>    </span><span style=color:#ebcb8b;>String </span><span style=color:#8fa1b3;>test</span><span style=color:#eff1f5;>();
</span><span style=color:#eff1f5;>}
</span></code></pre> <pre class=language-java data-lang=java style=background-color:#2b303b;color:#c0c5ce;><code class=language-java data-lang=java><span style=color:#b48ead;>package </span><span>com.modao.demo.biz.impl;
</span><span>
</span><span style=color:#b48ead;>import </span><span>com.modao.demo.biz.</span><span style=color:#ebcb8b;>DemoService</span><span>;
</span><span style=color:#b48ead;>import </span><span>org.springframework.stereotype.</span><span style=color:#ebcb8b;>Service</span><span>;
</span><span>
</span><span>@</span><span style=color:#bf616a;>Service
</span><span style=color:#b48ead;>public class </span><span style=color:#ebcb8b;>DemoServiceImpl </span><span style=color:#b48ead;>implements </span><span style=color:#a3be8c;>DemoService </span><span style=color:#eff1f5;>{
</span><span style=color:#eff1f5;>
</span><span style=color:#eff1f5;>    @</span><span style=color:#bf616a;>Override
</span><span style=color:#eff1f5;>    </span><span style=color:#b48ead;>public </span><span style=color:#ebcb8b;>String </span><span style=color:#8fa1b3;>test</span><span style=color:#eff1f5;>() {
</span><span style=color:#eff1f5;>  </span><span style=color:#b48ead;>return </span><span>"</span><span style=color:#a3be8c;>interface test</span><span>"</span><span style=color:#eff1f5;>;
</span><span style=color:#eff1f5;>    }
</span><span style=color:#eff1f5;>}
</span></code></pre><li><p>为 biz 模块添加依赖</p> <pre class=language-xml data-lang=xml style=background-color:#2b303b;color:#c0c5ce;><code class=language-xml data-lang=xml><span><</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>  <</span><span style=color:#bf616a;>groupId</span><span>>org.springframework&LT/</span><span style=color:#bf616a;>groupId</span><span>>
</span><span>  <</span><span style=color:#bf616a;>artifactId</span><span>>spring-context&LT/</span><span style=color:#bf616a;>artifactId</span><span>>
</span><span>&LT/</span><span style=color:#bf616a;>dependency</span><span>>
</span></code></pre><li><p>DemoController 通过 @Autowired 注解注入 DemoService ，修改 DemoController 的 test 方法使之调用 DemoService 的 test 方法</p> <pre class=language-java data-lang=java style=background-color:#2b303b;color:#c0c5ce;><code class=language-java data-lang=java><span style=color:#b48ead;>package </span><span>com.modao.demo.biz.impl;
</span><span>
</span><span style=color:#b48ead;>import </span><span>com.modao.demo.biz.</span><span style=color:#ebcb8b;>DemoService</span><span>;
</span><span style=color:#b48ead;>import </span><span>org.springframework.stereotype.</span><span style=color:#ebcb8b;>Service</span><span>;
</span><span>
</span><span>@</span><span style=color:#bf616a;>Service
</span><span style=color:#b48ead;>public class </span><span style=color:#ebcb8b;>DemoServiceImpl </span><span style=color:#b48ead;>implements </span><span style=color:#a3be8c;>DemoService </span><span style=color:#eff1f5;>{
</span><span style=color:#eff1f5;>
</span><span style=color:#eff1f5;>    @</span><span style=color:#bf616a;>Override
</span><span style=color:#eff1f5;>    </span><span style=color:#b48ead;>public </span><span style=color:#ebcb8b;>String </span><span style=color:#8fa1b3;>test</span><span style=color:#eff1f5;>() {
</span><span style=color:#eff1f5;>  </span><span style=color:#b48ead;>return </span><span>"</span><span style=color:#a3be8c;>interface test</span><span>"</span><span style=color:#eff1f5;>;
</span><span style=color:#eff1f5;>    }
</span><span style=color:#eff1f5;>}
</span></code></pre><li><p>再次运行 DemoWebApplication 类中的 main 方法启动项目，发现如下报错</p> <pre style=background-color:#2b303b;color:#c0c5ce;><code><span>***************************
</span><span>
</span><span>Description:
</span><span>
</span><span>Field demoService in com.modao.demo.web.controller.DemoController required a bean of type 'com.modao.demo.biz.DemoService' that could not be found.
</span><span>
</span><span>The injection point has the following annotations:
</span><span>	- @org.springframework.beans.factory.annotation.Autowired(required=true)
</span><span>
</span><span>
</span><span>Action:
</span><span>
</span><span>Consider defining a bean of type 'com.modao.demo.biz.DemoService' in your configuration.
</span></code></pre> <p><strong>原因是找不到 DemoService 类</strong></p> <p>在 DemoWebApplication 入口类中增加包扫描，设置 @SpringBootApplication 注解中的 scanBasePackages 值为 com.modao.demo</p> <pre class=language-java data-lang=java style=background-color:#2b303b;color:#c0c5ce;><code class=language-java data-lang=java><span>@</span><span style=color:#bf616a;>SpringBootApplication</span><span>(</span><span style=color:#bf616a;>scanBasePackages </span><span>= "</span><span style=color:#a3be8c;>com.modao.demo</span><span>")
</span></code></pre><li><p>设置完后重新运行 main 方法，项目正常启动，访问 http://localhost:8080/demo/test 测试接口</p> <p>![image-20210113000035960](Spring Boot 项目实战（一）Maven 多模块项目搭建/image-20210113000035960.png)</p></ol><h3 id=ji-cheng-mybatis>集成 MyBatis</h3><p>以上接口均是静态的，不涉及数据库操作，下面将集成 MyBatis 访问数据库中的数据<ol><li><p>首先父 pom 文件中声明 mybatis-spring-boot-starter 及 lombok 依赖</p> <pre class=language-xml data-lang=xml style=background-color:#2b303b;color:#c0c5ce;><code class=language-xml data-lang=xml><span><</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>  <</span><span style=color:#bf616a;>groupId</span><span>>org.mybatis.spring.boot&LT/</span><span style=color:#bf616a;>groupId</span><span>>
</span><span>  <</span><span style=color:#bf616a;>artifactId</span><span>>mybatis-spring-boot-starter&LT/</span><span style=color:#bf616a;>artifactId</span><span>>
</span><span>  <</span><span style=color:#bf616a;>version</span><span>>2.1.4&LT/</span><span style=color:#bf616a;>version</span><span>>
</span><span>&LT/</span><span style=color:#bf616a;>dependency</span><span>>
</span><span><</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>  <</span><span style=color:#bf616a;>groupId</span><span>>org.projectlombok&LT/</span><span style=color:#bf616a;>groupId</span><span>>
</span><span>  <</span><span style=color:#bf616a;>artifactId</span><span>>lombok&LT/</span><span style=color:#bf616a;>artifactId</span><span>>
</span><span>  <</span><span style=color:#bf616a;>version</span><span>>1.18.16&LT/</span><span style=color:#bf616a;>version</span><span>>
</span><span>&LT/</span><span style=color:#bf616a;>dependency</span><span>>
</span></code></pre><li><p>其次在 dao 层中的 pom 文件中添加上述依赖</p> <pre class=language-xml data-lang=xml style=background-color:#2b303b;color:#c0c5ce;><code class=language-xml data-lang=xml><span><</span><span style=color:#bf616a;>dependencies</span><span>>
</span><span>  <</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>  <</span><span style=color:#bf616a;>groupId</span><span>>mysql&LT/</span><span style=color:#bf616a;>groupId</span><span>>
</span><span>    <</span><span style=color:#bf616a;>artifactId</span><span>>mysql-connector-java&LT/</span><span style=color:#bf616a;>artifactId</span><span>>
</span><span>  &LT/</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>  <</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>  <</span><span style=color:#bf616a;>groupId</span><span>>org.mybatis.spring.boot&LT/</span><span style=color:#bf616a;>groupId</span><span>>
</span><span>    <</span><span style=color:#bf616a;>artifactId</span><span>>mybatis-spring-boot-starter&LT/</span><span style=color:#bf616a;>artifactId</span><span>>
</span><span>  &LT/</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>  <</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>  <</span><span style=color:#bf616a;>groupId</span><span>>org.projectlombok&LT/</span><span style=color:#bf616a;>groupId</span><span>>
</span><span>    <</span><span style=color:#bf616a;>artifactId</span><span>>lombok&LT/</span><span style=color:#bf616a;>artifactId</span><span>>
</span><span>  &LT/</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>&LT/</span><span style=color:#bf616a;>dependencies</span><span>>
</span></code></pre><li><p>创建mysql数据库，数据库名为 test，新建一个表 test</p> <p>![image-20210113000632308](Spring Boot 项目实战（一）Maven 多模块项目搭建/image-20210113000632308.png)</p> <p>在IDEA上连接该数据库</p> <p>![image-20210113000728250](Spring Boot 项目实战（一）Maven 多模块项目搭建/image-20210113000728250.png)</p></ol><p>![image-20210113000750271](Spring Boot 项目实战（一）Maven 多模块项目搭建/image-20210113000750271.png)<p>![image-20210113000859382](Spring Boot 项目实战（一）Maven 多模块项目搭建/image-20210113000859382.png)<p>![image-20210113000922016](Spring Boot 项目实战（一）Maven 多模块项目搭建/image-20210113000922016.png)<p>点<code>1 of 7</code>选择想要连接的数据库，然后点图片中右上角的刷新<p>![image-20210113001324638](Spring Boot 项目实战（一）Maven 多模块项目搭建/image-20210113001324638.png)<ol start=4><li>IDEA安装插件 Free Mybatis plugin，在已连接的数据库的test表右键，选择 mybatis-genertaor</ol><p>![image-20210113001443198](Spring Boot 项目实战（一）Maven 多模块项目搭建/image-20210113001443198.png)<p>![image-20210113001534309](Spring Boot 项目实战（一）Maven 多模块项目搭建/image-20210113001534309.png)<ol start=5><li><p>之后在 dao 层创建 com.modao.demo.dao 包，通过 mybatis-genertaor 工具生成 dao 层相关文件（ DO 、 Mapper 、 xml ），目录结构如下</p> <pre style=background-color:#2b303b;color:#c0c5ce;><code><span>dao
</span><span>├── dao.iml
</span><span>├── pom.xml
</span><span>└── src
</span><span>    ├── main
</span><span>    │   ├── java
</span><span>    │   │   └── generate
</span><span>    │   │       ├── Test.java
</span><span>    │   │       └── TestDao.java
</span><span>    │   └── resources
</span><span>    │       └── generator
</span><span>    │           └── TestDao.xml
</span><span>    └── test
</span><span>        └── java
</span></code></pre><li><p>然后在 demo-web 层中的 resources 目录 创建 application.properties 文件并在其中添加 datasource 及 MyBatis 相关配置项</p> <pre style=background-color:#2b303b;color:#c0c5ce;><code><span>spring.datasource.driverClassName = com.mysql.cj.jdbc.Driver
</span><span>spring.datasource.url = jdbc:mysql://localhost:3306/test?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC&useSSL=false&allowPublicKeyRetrieval=true
</span><span>spring.datasource.username = root
</span><span>spring.datasource.password = 123456
</span><span>
</span><span>mybatis.mapper-locations = classpath:mybatis/*.xml
</span><span>mybatis.type-aliases-package = com.example.demo.dao.entity
</span></code></pre> <blockquote><p>注：如果生成的 xml 在 dao 层 resources 目录的子目录中则 mybatis.mapper-locations 需设置为 <code>classpath:mybatis/*/*.xml</code></blockquote><li><p>DemoServiceImpl 通过 @Autowired 注解注入 UserMapper ，修改 DemoServiceImpl 的 test 方法使之调用 UserMapper 的 selectById 方法</p> <pre class=language-java data-lang=java style=background-color:#2b303b;color:#c0c5ce;><code class=language-java data-lang=java><span>@</span><span style=color:#bf616a;>Service
</span><span style=color:#b48ead;>public class </span><span style=color:#ebcb8b;>DemoServiceImpl </span><span style=color:#b48ead;>implements </span><span style=color:#a3be8c;>DemoService </span><span style=color:#eff1f5;>{
</span><span style=color:#eff1f5;>
</span><span style=color:#eff1f5;>    @</span><span style=color:#bf616a;>Autowired
</span><span style=color:#eff1f5;>    </span><span style=color:#b48ead;>private </span><span style=color:#ebcb8b;>UserMapper </span><span style=color:#eff1f5;>userMapper;
</span><span style=color:#eff1f5;>
</span><span style=color:#eff1f5;>    @</span><span style=color:#bf616a;>Override
</span><span style=color:#eff1f5;>    </span><span style=color:#b48ead;>public </span><span style=color:#ebcb8b;>String </span><span style=color:#8fa1b3;>test</span><span style=color:#eff1f5;>() {
</span><span style=color:#eff1f5;>        </span><span style=color:#ebcb8b;>UserDO</span><span style=color:#eff1f5;> user </span><span>=</span><span style=color:#eff1f5;> userMapper.</span><span style=color:#bf616a;>selectById</span><span style=color:#eff1f5;>(</span><span style=color:#d08770;>1</span><span style=color:#eff1f5;>);
</span><span style=color:#eff1f5;>        </span><span style=color:#b48ead;>return</span><span style=color:#eff1f5;> user.</span><span style=color:#bf616a;>toString</span><span style=color:#eff1f5;>();
</span><span style=color:#eff1f5;>    }
</span><span style=color:#eff1f5;>}
</span></code></pre><li><p>再次运行 DemoWebApplication 类中的 main 方法启动项目，出现如下报错</p> <pre style=background-color:#2b303b;color:#c0c5ce;><code><span>***************************
</span><span>
</span><span>Description:
</span><span>
</span><span>Field userMapper in com.modao.demo.biz.impl.DemoServiceImpl required a bean of type 'com.modao.demo.dao.mapper.business.UserMapper' that could not be found.
</span><span>
</span><span>The injection point has the following annotations:
</span><span>	- @org.springframework.beans.factory.annotation.Autowired(required=true)
</span><span>
</span><span>
</span><span>Action:
</span><span>
</span><span>Consider defining a bean of type 'com.modao.demo.dao.mapper.business.UserMapper' in your configuration.
</span></code></pre> <p><strong>原因是找不到 UserMapper 类</strong></p> <p>在 DemoWebApplication入口类中增加 dao 层包扫描，添加 @MapperScan 注解并设置其值为 com.modao.demo.dao.mapper</p> <pre style=background-color:#2b303b;color:#c0c5ce;><code><span>@MapperScan("com.modao.demo.dao.mapper")
</span></code></pre> <p>设置完后重新运行 main 方法，项目正常启动，访问 http://localhost:8080/demo/test 测试接口</p></ol><p>![image-20210113003013104](Spring Boot 项目实战（一）Maven 多模块项目搭建/image-20210113003013104.png)<h2 id=wai-bu-tomcat-bu-shu-war-bao>外部 Tomcat 部署 war 包</h2><p>外部 Tomcat 部署的话，就不能依赖于入口类的 main 函数了，而是要以类似于 web.xml 文件配置的方式来启动 Spring应用上下文。<ol><li><p>在入口类中继承 SpringBootServletInitializer 并实现 configure 方法</p> <pre class=language-java data-lang=java style=background-color:#2b303b;color:#c0c5ce;><code class=language-java data-lang=java><span>@</span><span style=color:#bf616a;>SpringBootApplication</span><span>(</span><span style=color:#bf616a;>scanBasePackages </span><span>= "</span><span style=color:#a3be8c;>com.modao.demo</span><span>")
</span><span>@</span><span style=color:#bf616a;>MapperScan</span><span>("</span><span style=color:#a3be8c;>com.modao.demo.dao.mapper</span><span>")
</span><span style=color:#b48ead;>public class </span><span style=color:#ebcb8b;>DemoWebApplication </span><span style=color:#b48ead;>extends </span><span style=color:#a3be8c;>SpringBootServletInitializer </span><span style=color:#eff1f5;>{
</span><span style=color:#eff1f5;>    @</span><span style=color:#bf616a;>Override
</span><span style=color:#eff1f5;>    </span><span style=color:#b48ead;>protected </span><span style=color:#ebcb8b;>SpringApplicationBuilder </span><span style=color:#8fa1b3;>configure</span><span style=color:#eff1f5;>(</span><span style=color:#ebcb8b;>SpringApplicationBuilder </span><span style=color:#bf616a;>builder</span><span style=color:#eff1f5;>) {
</span><span style=color:#eff1f5;>        </span><span style=color:#b48ead;>return</span><span style=color:#eff1f5;> builder.</span><span style=color:#bf616a;>sources</span><span style=color:#eff1f5;>(</span><span style=color:#ebcb8b;>DemoWebApplication</span><span style=color:#eff1f5;>.</span><span style=color:#bf616a;>class</span><span style=color:#eff1f5;>);
</span><span style=color:#eff1f5;>    }
</span><span style=color:#eff1f5;>    </span><span style=color:#b48ead;>public static void </span><span style=color:#8fa1b3;>main</span><span style=color:#eff1f5;>(</span><span style=color:#ebcb8b;>String</span><span style=color:#b48ead;>[] </span><span style=color:#bf616a;>args</span><span style=color:#eff1f5;>) {
</span><span style=color:#eff1f5;>        </span><span style=color:#ebcb8b;>SpringApplication</span><span style=color:#eff1f5;>.</span><span style=color:#bf616a;>run</span><span style=color:#eff1f5;>(</span><span style=color:#ebcb8b;>DemoWebApplication</span><span style=color:#eff1f5;>.</span><span style=color:#bf616a;>class</span><span style=color:#eff1f5;>, args);
</span><span style=color:#eff1f5;>    }
</span><span style=color:#eff1f5;>}
</span></code></pre><li><p>之前在 web 引入了 spring-boot-starter-web 的依赖，该依赖包包含内嵌的 Tomcat 容器，所以直接部署在外部 Tomcat 会冲突报错。这里在 web 层中的 pom 文件中重定义 spring-boot-starter-tomcat 依赖包的「 scope 」即可解决该问题。</p> <pre class=language-xml data-lang=xml style=background-color:#2b303b;color:#c0c5ce;><code class=language-xml data-lang=xml><span><</span><span style=color:#bf616a;>dependency</span><span>>
</span><span>    <</span><span style=color:#bf616a;>groupId</span><span>>org.springframework.boot&LT/</span><span style=color:#bf616a;>groupId</span><span>>
</span><span>    <</span><span style=color:#bf616a;>artifactId</span><span>>spring-boot-starter-tomcat&LT/</span><span style=color:#bf616a;>artifactId</span><span>>
</span><span>    <</span><span style=color:#bf616a;>scope</span><span>>provided&LT/</span><span style=color:#bf616a;>scope</span><span>>
</span><span>&LT/</span><span style=color:#bf616a;>dependency</span><span>>
</span></code></pre><li><p>声明 web 层的打包方式及最终的包名</p> <pre class=language-xml data-lang=xml style=background-color:#2b303b;color:#c0c5ce;><code class=language-xml data-lang=xml><span><</span><span style=color:#bf616a;>packaging</span><span>>war&LT/</span><span style=color:#bf616a;>packaging</span><span>>
</span><span>...省略其余部分...
</span><span><</span><span style=color:#bf616a;>build</span><span>>
</span><span>    <</span><span style=color:#bf616a;>finalName</span><span>>demo&LT/</span><span style=color:#bf616a;>finalName</span><span>>
</span><span>&LT/</span><span style=color:#bf616a;>build</span><span>>
</span></code></pre><li><p>此时在 web 层目录执行 <code>mvn clean install</code> 即可打出一个名为 demo.war 的包。</p></ol><h2 id=maven-profile-duo-huan-jing-da-bao>Maven Profile 多环境打包</h2><p>在日常开发中，通常不止一套环境，如开发环境、测试环境、预发环境、生成环境，而每个环境的配置项可能都不一样，这就需要用到多环境打包来解决这个问题。<ol><li><p>在 web 层的 resources 目录中新建 conf 目录，再在其中按照环境创建相应目录，这里创建开发环境「 dev 」及测试环境「 test 」，再将原本的 application.properties 文件分别拷贝一份到两个目录中，根据环境修改其中的配置项，最后删除原本的配置文件。得到目录结构如下：</p> <pre style=background-color:#2b303b;color:#c0c5ce;><code><span>|-- resources
</span><span>    |-- conf
</span><span>      |-- dev
</span><span>      |   |-- application.properties
</span><span>      |-- test
</span><span>          |-- application.properties
</span></code></pre><li><p>往 demo-web 层的 pom 文件添加 profile 标签</p> <pre class=language-xml data-lang=xml style=background-color:#2b303b;color:#c0c5ce;><code class=language-xml data-lang=xml><span><</span><span style=color:#bf616a;>profiles</span><span>>
</span><span>    <</span><span style=color:#bf616a;>profile</span><span>>
</span><span>        <</span><span style=color:#bf616a;>id</span><span>>dev&LT/</span><span style=color:#bf616a;>id</span><span>>
</span><span>        <</span><span style=color:#bf616a;>properties</span><span>>
</span><span>            <</span><span style=color:#bf616a;>profile.env</span><span>>dev&LT/</span><span style=color:#bf616a;>profile.env</span><span>>
</span><span>        &LT/</span><span style=color:#bf616a;>properties</span><span>>
</span><span>        <</span><span style=color:#bf616a;>activation</span><span>>
</span><span>            <</span><span style=color:#bf616a;>activeByDefault</span><span>>true&LT/</span><span style=color:#bf616a;>activeByDefault</span><span>>
</span><span>        &LT/</span><span style=color:#bf616a;>activation</span><span>>
</span><span>    &LT/</span><span style=color:#bf616a;>profile</span><span>>
</span><span>    <</span><span style=color:#bf616a;>profile</span><span>>
</span><span>        <</span><span style=color:#bf616a;>id</span><span>>test&LT/</span><span style=color:#bf616a;>id</span><span>>
</span><span>        <</span><span style=color:#bf616a;>properties</span><span>>
</span><span>            <</span><span style=color:#bf616a;>profile.env</span><span>>test&LT/</span><span style=color:#bf616a;>profile.env</span><span>>
</span><span>        &LT/</span><span style=color:#bf616a;>properties</span><span>>
</span><span>    &LT/</span><span style=color:#bf616a;>profile</span><span>>
</span><span>&LT/</span><span style=color:#bf616a;>profiles</span><span>>
</span></code></pre> <blockquote><p>注：其中 dev 为默认激活的 profile ，如要增加其他环境按照上述步骤操作即可。</blockquote><li><p>设置打包时资源文件路径</p> <pre class=language-xml data-lang=xml style=background-color:#2b303b;color:#c0c5ce;><code class=language-xml data-lang=xml><span><</span><span style=color:#bf616a;>build</span><span>>
</span><span>    <</span><span style=color:#bf616a;>finalName</span><span>>demo&LT/</span><span style=color:#bf616a;>finalName</span><span>>
</span><span>    <</span><span style=color:#bf616a;>resources</span><span>>
</span><span>        <</span><span style=color:#bf616a;>resource</span><span>>
</span><span>            <</span><span style=color:#bf616a;>directory</span><span>>${basedir}/src/main/resources&LT/</span><span style=color:#bf616a;>directory</span><span>>
</span><span>            <</span><span style=color:#bf616a;>excludes</span><span>>
</span><span>                <</span><span style=color:#bf616a;>exclude</span><span>>conf/**&LT/</span><span style=color:#bf616a;>exclude</span><span>>
</span><span>            &LT/</span><span style=color:#bf616a;>excludes</span><span>>
</span><span>        &LT/</span><span style=color:#bf616a;>resource</span><span>>
</span><span>        <</span><span style=color:#bf616a;>resource</span><span>>
</span><span>            <</span><span style=color:#bf616a;>directory</span><span>>src/main/resources/conf/${profile.env}&LT/</span><span style=color:#bf616a;>directory</span><span>>
</span><span>        &LT/</span><span style=color:#bf616a;>resource</span><span>>
</span><span>    &LT/</span><span style=color:#bf616a;>resources</span><span>>
</span><span>&LT/</span><span style=color:#bf616a;>build</span><span>>
</span></code></pre> <blockquote><p>注：${basedir} 为当前子模块的根目录</blockquote><li><p>打包时通过「 P 」参数指定 profile</p> <pre class=language-bash data-lang=bash style=background-color:#2b303b;color:#c0c5ce;><code class=language-bash data-lang=bash><span style=color:#bf616a;>mvn</span><span> clean install</span><span style=color:#bf616a;> -P</span><span> test
</span></code></pre></ol><h2 id=zi-ding-yi-archetype-mo-ban>自定义 archetype 模板</h2><h3 id=shi-yao-shi-archetype-mo-ban>什么是 archetype 模板？</h3><p>archetype 是一个 Maven 项目模板工具包，通过 archetype 我们可以快速搭建 Maven 项目。<p>每个模板里其实就是附带不同的依赖和插件。一般在公司私服里都会有属于本公司的一套 archetype 模板，里面有着调试好的项目用到的依赖包和版本号。<p>![image-20210113142600471](Spring Boot 项目实战（一）Maven 多模块项目搭建/image-20210113142600471.png)<h3 id=chuang-jian-archetype-mo-ban>创建 archetype 模板</h3><ol><li><p>cd 到项目根目录（即父 pom 文件所在目录）执行 mvn 命令，此时会在项目根目录生成 target 目录，其包含一个名为 generated-sources 的目录</p> <pre class=language-bash data-lang=bash style=background-color:#2b303b;color:#c0c5ce;><code class=language-bash data-lang=bash><span style=color:#bf616a;>mvn</span><span> archetype:create-from-project
</span></code></pre><li><p>打开「 /target/generated-sources/archetype/src/main/resources/META-INF/maven/ 」目录下的 archetype-metadata.xml 文件，从中清理一些不需要的文件，如 IDEA 的一些文件（.idea、.iml）等。</p> <pre class=language-xml data-lang=xml style=background-color:#2b303b;color:#c0c5ce;><code class=language-xml data-lang=xml><span><</span><span style=color:#bf616a;>fileSet </span><span style=color:#d08770;>filtered</span><span>="</span><span style=color:#a3be8c;>true</span><span>" </span><span style=color:#d08770;>encoding</span><span>="</span><span style=color:#a3be8c;>UTF-8</span><span>">
</span><span>    <</span><span style=color:#bf616a;>directory</span><span>>.idea/libraries&LT/</span><span style=color:#bf616a;>directory</span><span>>
</span><span>    <</span><span style=color:#bf616a;>includes</span><span>>
</span><span>        <</span><span style=color:#bf616a;>include</span><span>>**/*.xml&LT/</span><span style=color:#bf616a;>include</span><span>>
</span><span>    &LT/</span><span style=color:#bf616a;>includes</span><span>>
</span><span>&LT/</span><span style=color:#bf616a;>fileSet</span><span>>
</span><span><</span><span style=color:#bf616a;>fileSet </span><span style=color:#d08770;>filtered</span><span>="</span><span style=color:#a3be8c;>true</span><span>" </span><span style=color:#d08770;>encoding</span><span>="</span><span style=color:#a3be8c;>UTF-8</span><span>">
</span><span>    <</span><span style=color:#bf616a;>directory</span><span>>.idea/inspectionProfiles&LT/</span><span style=color:#bf616a;>directory</span><span>>
</span><span>    <</span><span style=color:#bf616a;>includes</span><span>>
</span><span>        <</span><span style=color:#bf616a;>include</span><span>>**/*.xml&LT/</span><span style=color:#bf616a;>include</span><span>>
</span><span>    &LT/</span><span style=color:#bf616a;>includes</span><span>>
</span><span>&LT/</span><span style=color:#bf616a;>fileSet</span><span>>
</span><span><</span><span style=color:#bf616a;>fileSet </span><span style=color:#d08770;>filtered</span><span>="</span><span style=color:#a3be8c;>true</span><span>" </span><span style=color:#d08770;>encoding</span><span>="</span><span style=color:#a3be8c;>UTF-8</span><span>">
</span><span>    <</span><span style=color:#bf616a;>directory</span><span>>.idea/artifacts&LT/</span><span style=color:#bf616a;>directory</span><span>>
</span><span>    <</span><span style=color:#bf616a;>includes</span><span>>
</span><span>        <</span><span style=color:#bf616a;>include</span><span>>**/*.xml&LT/</span><span style=color:#bf616a;>include</span><span>>
</span><span>    &LT/</span><span style=color:#bf616a;>includes</span><span>>
</span><span>&LT/</span><span style=color:#bf616a;>fileSet</span><span>>
</span><span><</span><span style=color:#bf616a;>fileSet </span><span style=color:#d08770;>filtered</span><span>="</span><span style=color:#a3be8c;>true</span><span>" </span><span style=color:#d08770;>encoding</span><span>="</span><span style=color:#a3be8c;>UTF-8</span><span>">
</span><span>    <</span><span style=color:#bf616a;>directory</span><span>>.idea&LT/</span><span style=color:#bf616a;>directory</span><span>>
</span><span>    <</span><span style=color:#bf616a;>includes</span><span>>
</span><span>        <</span><span style=color:#bf616a;>include</span><span>>**/*.xml&LT/</span><span style=color:#bf616a;>include</span><span>>
</span><span>    &LT/</span><span style=color:#bf616a;>includes</span><span>>
</span><span>&LT/</span><span style=color:#bf616a;>fileSet</span><span>>
</span></code></pre><li><p>然后 cd target/generated-sources/archetype/，然后执行 install 命令，在本地仓库的根目录生成 archetype-catalog.xml 骨架配置文件</p> <pre class=language-bash data-lang=bash style=background-color:#2b303b;color:#c0c5ce;><code class=language-bash data-lang=bash><span style=color:#bf616a;>mvn</span><span> install
</span></code></pre> <p>文件内容如下：</p> <pre class=language-xml data-lang=xml style=background-color:#2b303b;color:#c0c5ce;><code class=language-xml data-lang=xml><span>&LT?</span><span style=color:#bf616a;>xml </span><span style=color:#d08770;>version</span><span>="</span><span style=color:#a3be8c;>1.0</span><span>" </span><span style=color:#d08770;>encoding</span><span>="</span><span style=color:#a3be8c;>UTF-8</span><span>"?>
</span><span><</span><span style=color:#bf616a;>archetype-catalog </span><span style=color:#d08770;>xsi:schemaLocation</span><span>="</span><span style=color:#a3be8c;>http://maven.apache.org/plugins/maven-archetype-plugin/archetype-catalog/1.0.0 http://maven.apache.org/xsd/archetype-catalog-1.0.0.xsd</span><span>"
</span><span>    </span><span style=color:#d08770;>xmlns</span><span>="</span><span style=color:#a3be8c;>http://maven.apache.org/plugins/maven-archetype-plugin/archetype-catalog/1.0.0</span><span>"
</span><span>    </span><span style=color:#d08770;>xmlns:xsi</span><span>="</span><span style=color:#a3be8c;>http://www.w3.org/2001/XMLSchema-instance</span><span>">
</span><span>  <</span><span style=color:#bf616a;>archetypes</span><span>>
</span><span>    <</span><span style=color:#bf616a;>archetype</span><span>>
</span><span>      <</span><span style=color:#bf616a;>groupId</span><span>>com.modao&LT/</span><span style=color:#bf616a;>groupId</span><span>>
</span><span>      <</span><span style=color:#bf616a;>artifactId</span><span>>demo-archetype&LT/</span><span style=color:#bf616a;>artifactId</span><span>>
</span><span>      <</span><span style=color:#bf616a;>version</span><span>>0.0.1-SNAPSHOT&LT/</span><span style=color:#bf616a;>version</span><span>>
</span><span>      <</span><span style=color:#bf616a;>description</span><span>>Demo project for Spring Boot&LT/</span><span style=color:#bf616a;>description</span><span>>
</span><span>    &LT/</span><span style=color:#bf616a;>archetype</span><span>>
</span><span>  &LT/</span><span style=color:#bf616a;>archetypes</span><span>>
</span><span>&LT/</span><span style=color:#bf616a;>archetype-catalog</span><span>>
</span></code></pre></ol><h3 id=shi-yong-archetype-mo-ban>使用 archetype 模板</h3><p>到本机的工作目录执行 mvn archetype:generate -DarchetypeCatalog=local 从本地 archeType 模板中创建项目<pre style=background-color:#2b303b;color:#c0c5ce;><code><span>E:\Idea_workspace>mvn archetype:generate -DarchetypeCatalog=local
</span><span>[INFO] Scanning for projects...
</span><span>[INFO]
</span><span>[INFO] ------------------< org.apache.maven:standalone-pom >----------------+++
</span><span>[INFO] Building Maven Stub Project (No POM) 1
</span><span>[INFO] --------------------------------[ pom ]------------------------------+++
</span><span>[INFO]
</span><span>[INFO] >>> maven-archetype-plugin:3.2.0:generate (default-cli) > generate-sources @ standalone-pom >>>
</span><span>[INFO]
</span><span>[INFO] <<< maven-archetype-plugin:3.2.0:generate (default-cli) < generate-sources @ standalone-pom <<<
</span><span>[INFO]
</span><span>[INFO]
</span><span>[INFO] --- maven-archetype-plugin:3.2.0:generate (default-cli) @ standalone-pom +++
</span><span>[INFO] Generating project in Interactive mode
</span><span>[INFO] No archetype defined. Using maven-archetype-quickstart (org.apache.maven.archetypes:maven-archetype-quickstart:1.0)
</span><span>Choose archetype:
</span><span>1: local -> com.modao:demo-archetype (Demo project for Spring Boot)
</span><span>Choose a number or apply filter (format: [groupId:]artifactId, case sensitive contains): : 1
</span><span>Define value for property 'groupId': com.orz.test
</span><span>Define value for property 'artifactId': test
</span><span>Define value for property 'version' 1.0-SNAPSHOT: :
</span><span>Define value for property 'package' com.orz.test: :
</span><span>Confirm properties configuration:
</span><span>groupId: com.orz.test
</span><span>artifactId: test
</span><span>version: 1.0-SNAPSHOT
</span><span>package: com.orz.test
</span><span> Y: : y
</span><span>[INFO] -------------------------------------------------------------------------+++
</span><span>[INFO] Using following parameters for creating project from Archetype: demo-archetype:0.0.1-SNAPSHOT
</span><span>[INFO] -------------------------------------------------------------------------+++
</span><span>[INFO] Parameter: groupId, Value: com.orz.test
</span><span>[INFO] Parameter: artifactId, Value: test
</span><span>[INFO] Parameter: version, Value: 1.0-SNAPSHOT
</span><span>[INFO] Parameter: package, Value: com.orz.test
</span><span>[INFO] Parameter: packageInPathFormat, Value: com/orz/test
</span><span>[INFO] Parameter: package, Value: com.orz.test
</span><span>[INFO] Parameter: version, Value: 1.0-SNAPSHOT
</span><span>[INFO] Parameter: groupId, Value: com.orz.test
</span><span>[INFO] Parameter: artifactId, Value: test
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\artifacts\web_war.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\artifacts\web_war_exploded.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\dataSources\901ef934-d647-4f93-9dde-5974d2f053a2.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__ch_qos_logback_logback_classic_1_2_3.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__ch_qos_logback_logback_core_1_2_3.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__com_fasterxml_jackson_core_jackson_annotations_2_11_3.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__com_fasterxml_jackson_core_jackson_core_2_11_3.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__com_fasterxml_jackson_core_jackson_databind_2_11_3.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__com_fasterxml_jackson_datatype_jackson_datatype_jdk8_2_11_3.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__com_fasterxml_jackson_datatype_jackson_datatype_jsr310_2_11_3.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__com_fasterxml_jackson_module_jackson_module_parameter_names_2_11_3.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__com_zaxxer_HikariCP_3_4_5.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__jakarta_annotation_jakarta_annotation_api_1_3_5.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__mysql_mysql_connector_java_8_0_22.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_apache_logging_log4j_log4j_api_2_13_3.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_apache_logging_log4j_log4j_to_slf4j_2_13_3.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_apache_tomcat_embed_tomcat_embed_core_9_0_41.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_apache_tomcat_embed_tomcat_embed_websocket_9_0_41.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_glassfish_jakarta_el_3_0_3.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_mybatis_mybatis_3_5_6.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_mybatis_mybatis_spring_2_0_6.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_mybatis_spring_boot_mybatis_spring_boot_autoconfigure_2_1_4.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_mybatis_spring_boot_mybatis_spring_boot_starter_2_1_4.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_projectlombok_lombok_1_18_16.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_slf4j_jul_to_slf4j_1_7_30.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_slf4j_slf4j_api_1_7_30.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_springframework_boot_spring_boot_2_3_7_RELEASE.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_springframework_boot_spring_boot_autoconfigure_2_3_7_RELEASE.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_springframework_boot_spring_boot_starter_2_3_7_RELEASE.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_springframework_boot_spring_boot_starter_jdbc_2_3_7_RELEASE.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_springframework_boot_spring_boot_starter_json_2_3_7_RELEASE.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_springframework_boot_spring_boot_starter_logging_2_3_7_RELEASE.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_springframework_boot_spring_boot_starter_tomcat_2_3_7_RELEASE.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_springframework_boot_spring_boot_starter_web_2_3_7_RELEASE.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_springframework_spring_aop_5_2_12_RELEASE.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_springframework_spring_beans_5_2_12_RELEASE.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_springframework_spring_context_5_2_12_RELEASE.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_springframework_spring_core_5_2_12_RELEASE.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_springframework_spring_expression_5_2_12_RELEASE.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_springframework_spring_jcl_5_2_12_RELEASE.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_springframework_spring_jdbc_5_2_12_RELEASE.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_springframework_spring_tx_5_2_12_RELEASE.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_springframework_spring_webmvc_5_2_12_RELEASE.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_springframework_spring_web_5_2_12_RELEASE.xml
</span><span>[WARNING] Don't override file E:\Idea_workspace\test\.idea\libraries\Maven__org_yaml_snakeyaml_1_26.xml
</span><span>[INFO] Parent element not overwritten in E:\Idea_workspace\test\biz\pom.xml
</span><span>[INFO] Parent element not overwritten in E:\Idea_workspace\test\dao\pom.xml
</span><span>[INFO] Parent element not overwritten in E:\Idea_workspace\test\common\pom.xml
</span><span>[INFO] Parent element not overwritten in E:\Idea_workspace\test\web\pom.xml
</span><span>[INFO] Project created from Archetype in dir: E:\Idea_workspace\test
</span><span>[INFO] ---------------------------------------------------------------------+++
</span><span>[INFO] BUILD SUCCESS
</span><span>[INFO] ---------------------------------------------------------------------+++
</span><span>[INFO] Total time:  01:11 min
</span><span>[INFO] Finished at: 2021-01-13
</span><span>T14:50:54+08:00
</span><span>[INFO] ---------------------------------------------------------------------+++
</span></code></pre><p>上面罗列出了所有可用的模板，首先选择使用哪个模板，这里选择 1 ，其次输入「 groupId 」、「 articleId 」、「 version 」及「 package 」，然后输入「 Y 」确认创建，最终项目创建成功。<blockquote><p>原文教程并未产生如此多警告，可能是之前清理<p>archetype-metadata.xml 文件中一些不需要的文件时，因为我不知道删除哪些而没动手吧</blockquote><h2 id=jie-yu>结语</h2><p>至此 Spring Boot Maven 多模块项目的搭建过程已经介绍完毕，后续会在此基础上继续集成一些中间件。<blockquote><p>原文作者的源码：https://github.com/SymonLin/demo</blockquote></div></div></div><footer class=footer__poweredby><p class=caption>© 2022 All Rights Reserved modao::rustacean@aliyun.com<p class=caption>© Powered by <a href=https://www.getzola.org/>Zola</a><p class=caption>© Theme: <a href=https://github.com/pawroman/zola-theme-terminimal/>Terminimal</a> by pawroman<p class=caption><a href=https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh rel=license>自由转载-非商用-非衍生-保持署名</a></footer></div>