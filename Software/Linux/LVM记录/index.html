<!DOCTYPE html>
<html>
<!-- html页面布局的head -->

<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
	<title>
		modao
	</title>

	<!-- 百度统计代码 -->
	<script>
		var _hmt = _hmt || [];
		(function () {
			var hm = document.createElement("script");
			hm.src = "https://hm.baidu.com/hm.js?902dc461fe0d25f09e74e0d04677b6d8";
			var s = document.getElementsByTagName("script")[0];
			s.parentNode.insertBefore(hm, s);
		})();
	</script>

	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-N2WTGJE0M5"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag() { dataLayer.push(arguments); }
		gtag('js', new Date());

		gtag('config', 'G-N2WTGJE0M5');
	</script>
<meta name="generator" content="Hexo 5.4.0"></head>

  <body>

    <!-- 文章详情页模板 -->

<!-- 主页标题栏 -->

<link rel="stylesheet" href="/css/navigatebar.css">


<header class="header">
	<div class="topbar">
		<div class="topbar-button topbar-mine">
			<a href="/">
				modao
			</a>
		</div>
		
			<div class="topbar-button">
				<a href="/">
					Home
				</a>
			</div>
		
			<div class="topbar-button">
				<a href="/categories">
					Categories
				</a>
			</div>
		
			<div class="topbar-button">
				<a href="/links">
					Friends
				</a>
			</div>
		
			<div class="topbar-button">
				<a href="/sites">
					Sites
				</a>
			</div>
		
			<div class="topbar-button">
				<a href="/stars">
					Stars
				</a>
			</div>
		

	</div>
	<div class="slogan">
		「工作日还有多少天，休息日还剩几小时」
	</div>
</header>


<link rel="stylesheet" href="/css/font.css">


<link rel="stylesheet" href="/css/post.css" media="screen and (min-width: 600px)">


<link rel="stylesheet" href="/css/post_mobile.css" media="screen and (max-width: 600px)">


<link rel="stylesheet" href="/css/highlight.css">




<div class="toc">
<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#VFS-Cannot-open-root-device-%E8%A7%A3%E5%86%B3%E6%80%9D%E8%B7%AF"><span class="toc-text">VFS: Cannot open root device 解决思路</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%90%86%E8%AE%BA"><span class="toc-text">理论</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B"><span class="toc-text">实例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#init-xxx-%E4%B8%AD-xxx-%E7%9A%84%E6%A0%BC%E5%BC%8F"><span class="toc-text">init&#x3D;xxx 中 xxx 的格式</span></a></li></ol></li></ol></li></ol></li></ol>
</div>

<div class="content-area">
	<div class="title">
		LVM记录
	</div>
	
	<div class="page-date">
		2021-06-01
	</div>
	
	<div class="category-area">
		
			 
				「
				<div class="category">
					<a href="/categories/Linux">Linux</a>
				
				</div>
				」
			
		
	</div>
	
	<div class="content">
		<p>重装了下系统，用上了LVM</p>
<span id="more"></span>

<p>LVM：</p>
<ul>
<li>  物理卷PV</li>
<li>  卷组VG：将物理卷划分为可分配的逻辑块</li>
<li>  逻辑卷LV：多个逻辑块组成固定大小</li>
</ul>
<p>流程：多个磁盘/分区/raid–&gt;多个物理卷PV–&gt;合成卷组VG–&gt;从VG划分出逻辑卷LV–&gt;格式化LV，挂载使用。</p>
<p>参考：</p>
<ul>
<li><p>  <a target="_blank" rel="noopener" href="https://www.cnblogs.com/diantong/p/10554831.html">LVM管理</a></p>
</li>
<li><p>  <a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1p541187V6">LVM逻辑卷</a></p>
</li>
</ul>
<h1 id="VFS-Cannot-open-root-device-解决思路"><a href="#VFS-Cannot-open-root-device-解决思路" class="headerlink" title="VFS: Cannot open root device 解决思路"></a>VFS: Cannot open root device 解决思路</h1><h4 id="理论"><a href="#理论" class="headerlink" title="理论"></a>理论</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs plaintext">VFS: Cannot open root device \&quot;%s\&quot;(A) or %s(B): error %d(C)\n&quot;<br>Please append a correct \&quot;root=\&quot; boot option; here are the available partitions:\n<br>VFS: Unable to mount root fs on %s(D)<br></code></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs plaintext">以上是 init/do_mounts.c 文件中的 函数mount_block_root 做的打印<br><br>表示  利用所有的文件系统 调用 do_mount_root  对 一个分区(通过是您指定的) 进行了挂载,但是还是挂载失败<br>上面的信息就是打印出来的帮助您定位错误的信息<br><br>内核会针对不同的情况对 A B C D 进行填充<br>A : 如果您指定的是 root=/dev/hda2 ,那么 A 为 &quot;/dev/&quot; 后面的 hda2<br>    如果您指定的是 root=/xxx/hda2(前五个字节不为&quot;/dev/&quot;) ,那么 A 为 /xxx/hda2<br>B : 根据您指定的 root=/dev/hda2 , 根据ROOT_DEV = name_to_dev_t(root_device_name); 算出来的设备号,从而算出来的主次设备号,格式 为 unknown-block(主设备号,次设备号)<br>C : do_mount_root 的返回值,返回值的定义在 内核代码中的 include/uapi/asm-generic/errno-base.h<br>D : 和B一样<br></code></pre></td></tr></table></figure>

<h4 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h4><ul>
<li>  1</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c">VFS: Cannot open root device <span class="hljs-string">&quot;mmcblk0p1&quot;</span> <span class="hljs-keyword">or</span> unknown-block(<span class="hljs-number">179</span>,<span class="hljs-number">1</span>): error <span class="hljs-number">-19</span><br><br>Please append a correct <span class="hljs-string">&quot;root=&quot;</span> boot option; here are the available partitions:<br><br>----------------------------------------------------------------<br><br>A为 mmcblk0p1<br>B为 unknown-block(<span class="hljs-number">179</span>,<span class="hljs-number">1</span>)<br>C为 <span class="hljs-number">19</span><br><br>A的格式是对的,mmc设备的分区名请参考 Documentation/block/cmdline-partition.txt<br>B表示 已经找到了mmc设备的驱动, 因为主次设备已经出来了,且是对的. 请参考 Documentation/devices.txt<br>C为<span class="hljs-number">19</span> 表示 <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ENODEV      19  <span class="hljs-comment">/* No such device */</span> </span><br><br><br>这个问题的结论是<br>    <span class="hljs-number">1.</span>有驱动<br>    <span class="hljs-number">2.</span>可查磁盘名级分区名是否正确<br>    <span class="hljs-number">3.</span>可查对应的文件系统<br><br></code></pre></td></tr></table></figure>

<ul>
<li>  2</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c">VFS: Cannot open root device <span class="hljs-string">&quot;mtdblock5&quot;</span> <span class="hljs-keyword">or</span> unknown-block(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>): error <span class="hljs-number">-6</span><br><br>----------------------------------------------------------------<br><br>A为 mtdblock5<br>B为 unknown-block(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>)<br>C为 <span class="hljs-number">-6</span><br><br>A的格式是对的<br>B <span class="hljs-number">0</span> = reserved as null device number ,表示没找到该设分区的设备号,驱动可能有问题<br>C <span class="hljs-number">-6</span> <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ENXIO        6  <span class="hljs-comment">/* No such device or address */</span></span><br><br><br>这个问题的结论是<br>    <span class="hljs-number">1.</span>查驱动是否存在<br>    <span class="hljs-number">2.</span>可查磁盘名级分区名是否正确<br>    <span class="hljs-number">3.</span>可查对应的文件系统<br><br></code></pre></td></tr></table></figure>

<ul>
<li>  3</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c">VFS: Cannot open root device <span class="hljs-string">&quot;nfs&quot;</span> <span class="hljs-keyword">or</span> unknown-block(<span class="hljs-number">0</span>,<span class="hljs-number">255</span>)<br>----------------------------------------------------------------<br>内核中nfs设置不对<br><br></code></pre></td></tr></table></figure>

<ul>
<li>  4</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c">No filesystem could mount root, tried:  ext3 ext2 cramfs vfat msdos iso9660 romfs  <br>kernel panic - <span class="hljs-keyword">not</span> syncing: VFS: Unable to mount root fs on unknown-block(<span class="hljs-number">31</span>,<span class="hljs-number">3</span>)<br>---------------------------<br>磁盘分区被格式化为xxx文件系统,内核镜像无该xxx文件系统的支持<br></code></pre></td></tr></table></figure>

<ul>
<li>  5</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c">一般挂载不上的话,会有打印 here are the available partitions:<br>然后在下面打印如下<br><br>Please append a correct <span class="hljs-string">&quot;root=&quot;</span> boot option; here are the available partitions:<br><span class="hljs-number">0300</span>	<span class="hljs-number">16777216</span>	hda 	driver:	ide-disk<br>    <span class="hljs-number">0301</span> 	<span class="hljs-number">499873</span>		hda1<br>    <span class="hljs-number">0302</span>	<span class="hljs-number">16277152</span> 	hda2<br><span class="hljs-number">1600</span>	<span class="hljs-number">4194302</span> hdc 	driver: ide-cdrom<br><span class="hljs-number">0800</span> 	<span class="hljs-number">2097152</span> sda 	driver: sd<br>    <span class="hljs-number">0801</span>	<span class="hljs-number">2096451</span>	sda1<br>Kernel panic - <span class="hljs-keyword">not</span> syncing: VFS: Unable to mount root fs on unknown-block(<span class="hljs-number">2</span>,<span class="hljs-number">0</span>)<br><br>-----------------<br>以下为注释<br><span class="hljs-number">0300</span>(十六进制数)	<span class="hljs-number">16777216</span>(有多少个磁盘扇区)	hda(磁盘名) 	driver(所用的驱动):	ide-disk<br>    <span class="hljs-number">0301</span>(十六进制数) 	<span class="hljs-number">499873</span>(有多少个扇区)		hda1(分区名)<br>    <span class="hljs-number">0302</span>	<span class="hljs-number">16277152</span> 	hda2<br><span class="hljs-number">1600</span>	<span class="hljs-number">4194302</span> hdc 	driver: ide-cdrom<br><span class="hljs-number">0800</span> 	<span class="hljs-number">2097152</span> sda 	driver: sd<br>    <span class="hljs-number">0801</span>	<span class="hljs-number">2096451</span>	sda1<br>Kernel panic - <span class="hljs-keyword">not</span> syncing: VFS: Unable to mount root fs on unknown-block(<span class="hljs-number">2</span>,<span class="hljs-number">0</span>)<br><br></code></pre></td></tr></table></figure>

<h4 id="init-xxx-中-xxx-的格式"><a href="#init-xxx-中-xxx-的格式" class="headerlink" title="init=xxx 中 xxx 的格式"></a>init=xxx 中 xxx 的格式</h4><figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">name_to_dev_t</span> 函数的注释<br><br><span class="hljs-number">1.</span> 十六进制数<br>    <span class="hljs-number">0x302</span> <span class="hljs-number">302</span> <span class="hljs-number">0X302</span><br>        <span class="hljs-comment">//3为主设备号,2为此设备号</span><br>        <span class="hljs-comment">//0xaaabb</span><br>        <span class="hljs-comment">//aaa代表主设备号</span><br>        <span class="hljs-comment">//bb代表设备号码</span><br><span class="hljs-number">2.</span>带冒号的数对<br>    <span class="hljs-number">3</span>:<span class="hljs-number">2</span> <br>        <span class="hljs-comment">// 只能是%u：无符号十进制整数</span><br>        <span class="hljs-comment">// 3 为主设备号</span><br>        <span class="hljs-comment">// 2 为此设备号</span><br><span class="hljs-number">3.</span> /dev/nfs<br>    <span class="hljs-comment">// setenv bootargs &#x27;noinitrd mem=64M console=ttySAC0 root=/dev/nfs nfsroot=192.168.0.3:/nfs ip=192.168.0.5&#x27;</span><br><br><span class="hljs-number">4.</span> 不以数字结尾的字符串且代表磁盘<br>    /dev/sda : 代表第<span class="hljs-number">1</span>个硬盘<br>    <br><span class="hljs-number">5.</span> 	以数字结尾的字符串且代表分区<br>    /dev/sda1 : 代表第<span class="hljs-number">1</span>个硬盘的第<span class="hljs-number">1</span>个分区<br><br><span class="hljs-number">6.</span>  已数字结尾的字符串且代表磁盘<br>    /dev/mmcblk0:代表第<span class="hljs-number">1</span>个mmc设备<br><span class="hljs-number">7.</span>  如果磁盘名以数字结尾,则分区名需要加p : /dev/&lt;disk_name&gt;p&lt;decimal&gt;<br>    /dev/mmcblk0p1<br><span class="hljs-number">6.</span>	PARTUUID=<span class="hljs-number">00112233</span><span class="hljs-number">-4455</span><span class="hljs-number">-6677</span><span class="hljs-number">-8899</span>-AABBCCDDEEFF<br><br>如果不为这几种,则返回 <span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>,<span class="hljs-number">0</span>). <br><br><br><br></code></pre></td></tr></table></figure>

	</div>
</div>
<!-- 返回顶部模块 -->
<div id="totop" style="position:fixed;bottom:150px;right:50px;cursor: pointer;font-size:26px;background-color:#8590a6">
	<a title="返回顶部" style="color:#04fa9f"><⇧></a>
</div>
<script src="/js/totop.js"></script>

  </body>

</html>