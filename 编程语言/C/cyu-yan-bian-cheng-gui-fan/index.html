<!doctype html><html lang=zh-Hans-CN><head><title>modao's blog</title><meta content="text/html; charset=utf-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1.0,maximum-scale=1" name=viewport><meta content=noodp name=robots><link href=https://modao.site/style.css rel=stylesheet><link href=https://modao.site/color/green.css rel=stylesheet><link href=https://modao.site/color/background_dark.css rel=stylesheet><link href=https://modao.site/font-hack.css rel=stylesheet><script src="https://www.googletagmanager.com/gtag/js?id=G-N2WTGJE0M5" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-N2WTGJE0M5');</script><body><div class=container><header class=header><div class=header__inner><div class=header__logo><a style="text-decoration: none;" href=https://modao.site> <div class=logo>MODAO</div> </a></div></div><nav class=menu><ul class=menu__inner><li class=active><a href=https://modao.site>Home</a><li><a href=https://modao.site/tags>Tags</a><li><a href=https://modao.site/language>PL</a><li><a href=https://modao.site/books>Books</a><li><a href=https://modao.site/links>Links</a><li><a href=https://modao.site/friend>Friend</a></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=https://modao.site/编程语言/C/cyu-yan-bian-cheng-gui-fan/>C语言编程规范</a></h1><div class=post-meta-inline><span class=post-date> 2021-12-04 </span></div><div class=post-content><p>C语言编程规范</p><span id=continue-reading></span><h2 id=dai-ma-ming-ming-gui-fan>代码命名规范</h2><p>通用规范：<ul><li>类型名用大写，变量名和常量名用小写<li>变量名前加变量类型，如u16count，ptext<li>所有宏定义、枚举项、结构体成员、联合体成员一定要加注释，并使用块注释</ul><p>具体规范：<ul><li><p>宏：</p> <ul><li>采用大写下划线，如果宏定义的是函数可以采用小写<li>为了更好地区分宏所属的模块，建议加模块前缀</ul><li><p>枚举</p> <ul><li>枚举类型名使用大写，如若使用typedef定义枚举名，则枚举类型名后面加_E后缀<li>枚举成员名使用大写<li>枚举成员名最好添加模块前缀</ul><li><p>结构体、联合体</p> <ul><li>类型名使用大写，如若使用typedef定义枚举名，则枚举类型名后面加_S后缀<li>成员变量名使用小写，且需要相应注释</ul><li><p>全局变量：一律使用小写</p> <ul><li>仅文件内部使用：添加s_um_前缀<li>文件外部能访问：添加g_um_前缀</ul><li><p>函数：一律使用小写下划线</p> <ul><li>仅供文件内部调用：可以不添加前缀<li>允许文件外部调用：添加um前缀<li>强调内部使用：添加__（双下划线）前缀</ul><li><p>局部变量：一律使用小写下划线</p><li><p>基本类型：类型名使用大写</p><li><p>编译器版本间的兼容：有内联需求的，应使用<code>__inline</code>而非直接<code>inline</code></p></ul><h2 id=yu-fa-he-yu-yi>语法和语义</h2><ol><li><p>变量定义后一定要初始化</p><li><p>删除未使用变量，去除编译时警告</p><li><p>函数无返回值则返回类型为void，函数无参数则参数类型为void，对有返回值的函数一定要处理返回值</p><li><p>声明统一放头文件或源文件最前面</p><li><p>debug版本中，函数传入的参数要使用assert进行检测，便于调试时排错</p><li><p>使用显示数据类型转换，避免编译器隐式转换</p><li><p>减少全局变量的使用</p><li><p>函数名和变量名不要同名，局部变量和全局变量不要同名</p><li><p>关于内存：</p> <ul><li>指针变量一定要初始化，无指向对象时先初始化为NULL，防止使用了野指针<li>动态分配内存要判断结果是否成功<li>malloc和free要配套使用<li>释放内存后，要将指针指向NULL，防止野指针</ul><li><p>常量</p> <ul><li>对外公开的放在头文件中，不公开的放在定义文件的头部<li>常量之间有密切联系时，应该在定义中显示出来，避免给出一些孤立的值<li>C++中有两种定义常量的方式： <ul><li>const：有数据类型，编译器对其进行安全类型检查，可调试<li>define：无数据类型，编译器不对其进行安全类型检查，不可调试</ul></ul><li><p>宏</p> <ul><li>使用宏定义表达式时，要使用完备的括号<li>宏定义有多条表达式，则表达式应该放在大括号中<li>使用宏时，不允许参数发生变化（自增自减）</ul><li><p>const关键字</p> <ul><li>使用const修饰函数参数时，只能修饰输入参数<li>C语言中，const修饰的是只读变量，C语言中定义常量的方法是宏define和枚举enum</ul><li><p>变量：定义时一定要初始化，尽管全局变量和静态变量会有默认的初始值</p><li><p>避免使用bool参数，原因：</p> <ul><li>bool参数值无意义，true/false的含义非常模糊，在调用时很难知道参数传达的意思<li>bool参数值不利于扩充</ul><li><p>关键字使用和语句使用规范</p> <ul><li><p>if语句</p> <ul><li>使用<code>if(NULL == p)</code>代替<code>if(p == NULL)</code>，避免写少了等号<li>多个if语句判断时，将能预测到的最多情况放在第一个if语句中，从而提高效率</ul><li><p>for语句</p> <ul><li><p>不可在循环体内修改循环控制变量，防止for循环失去控制</p><li><p>建议for语句的循环控制变量的取值采用“半开半闭区间”写法，采用“半开半闭区间”写法能够减少错误，例如防止数组越界</p><li><p>在多重循环中，如果有可能，应当将最长的循环放在最内层，最短的循环放在最外层，以减少CPU跨切循环层的次数</p><li><p><strong>如果循环体内存在逻辑判断，并且循环次数很大，宜将逻辑判断移到循环体的外面</strong>(不是很懂)</p> <pre class=language-c data-lang=c style=background-color:#2b303b;color:#c0c5ce;><code class=language-c data-lang=c><span style=color:#b48ead;>for </span><span>(i=</span><span style=color:#d08770;>0</span><span>; i&LTN; i++)
</span><span>{
</span><span style=color:#b48ead;>if </span><span>(condition)
</span><span style=color:#bf616a;>DoSomething</span><span>();
</span><span style=color:#b48ead;>else
</span><span style=color:#bf616a;>DoOtherthing</span><span>();
</span><span>}
</span><span style=color:#65737e;>//如果N非常大的话，应该采用右边的方法提高效率
</span><span style=color:#b48ead;>if </span><span>(condition)
</span><span>{
</span><span style=color:#b48ead;>for </span><span>(i=</span><span style=color:#d08770;>0</span><span>; i&LTN; i++)
</span><span style=color:#bf616a;>DoSomething</span><span>();
</span><span>}
</span><span style=color:#b48ead;>else
</span><span>{
</span><span style=color:#b48ead;>for </span><span>(i=</span><span style=color:#d08770;>0</span><span>; i&LTN; i++)
</span><span style=color:#bf616a;>DoOtherthing</span><span>();
</span><span>}
</span></code></pre><li><p>对于一次性的计算，不要放在for语句中</p></ul><li><p>switch语句</p> <ul><li>每个case语句的结尾不要忘记加break<li>不要忘记缺省分支default，即使不需要也应添加<code>default:break;</code><li>case后面的值只能是整形或字符型常量/常量表达式<li>case语句排列顺序： <ul><li>按字母或数字排序<li>正常情况放前面，异常情况放后面<li>按执行频率排列</ul><li>case语句中不能使用continue</ul><li><p>goto语句：少用、慎用</p><li><p>inline关键字：内联，空间换时间</p> <ul><li>必须与函数定义体放在一起才能使函数内联<li>以下情况不宜使用inline <ul><li>函数体代码较长<li>函数体内有循环</ul></ul><li><p>volatile关键字：修饰被不同线程访问和修改的变量，即修饰易变变量，保证每次读取时都重新读取</p><li><p>extern关键字：调用其他模块的变量或函数，要在本模块中用extern进行<strong>外部声明</strong></p><li><p>void关键字</p> <ul><li>函数没有返回值或没有参数时，应声明为void类型<li>函数参数为任意指针类型时，声明为void *</ul></ul></ol><h2 id=ji-qi-huo-ping-tai-xiang-guan>机器或平台相关</h2></div></div></div><footer class=footer__poweredby><p class=caption>© 2022 All Rights Reserved modao::rustacean@aliyun.com<p class=caption>© Powered by <a href=https://www.getzola.org/>Zola</a><p class=caption>© Theme: <a href=https://github.com/pawroman/zola-theme-terminimal/>Terminimal</a> by pawroman<p class=caption><a href=https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh rel=license>自由转载-非商用-非衍生-保持署名</a></footer></div>